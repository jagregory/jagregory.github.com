<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

    <title>James Gregory</title>
    <meta name="description" content="Code monkey. ThoughtWorks. Chief Agitator.
" />

    <meta name="HandheldFriendly" content="True" />
    <meta name="MobileOptimized" content="320" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css" href="/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400" />
    <!-- Customisation  -->
    <link rel="stylesheet" type="text/css" href="/css/main.css" />

</head>
<body class="home-template">

    <header class="main-header no-cover">
    <div class="vertical">
        <div class="main-header-content inner">
            <h1 class="page-title"><a href="/">James Gregory</a></h1>
            <h2 class="page-description">
                 Code monkey. ThoughtWorks. Chief Agitator.
 
            </h2>
        </div>
    </div>
    <a class="scroll-down icon-arrow-left" href="#content" data-offset="-45"><span class="hidden">Scroll Down</span></a>
</header>

<main id="content" class="content" role="main">
    <div class="extra-pagination inner">
        <nav class="pagination" role="pagination">
    
        
            <a class="newer-posts" href="/page15/" title="Previous Page">&laquo; Newer Posts</a>
      
    
    <span class="page-number"> Page 16 of 23 </span>
     
        <a class="older-posts" href="/page17/" title="Next Page">Older Posts &raquo;</a>
     
</nav>
    </div>

    

    <article class="post">
        <header class="post-header">
            <h2 class="post-title"><a href="/writings/your-forms-are-killing-me">Your Forms Are Killing Me</a></h2>
        </header>
        <section class="post-excerpt">
            <blockquote>
  <p>Note: I have no particular dislike of the website in question, in fact I read it on a regular basis, but what I’m about to talk about is a travesty. Although it does tie in rather nicely with a previous post of mine: <a href="/writings/bloated-forms">Bloated Forms</a>.</p>
</blockquote>

<p>I was browsing one of my regular watering holes (water of knowledge, of course!) - <a href="http://www.theserverside.net">The Server Side.Net</a> - and I felt the overwhelming urge to make a reply in the forum. Registration was required, of course, so off to register I went. What followed was purely horrible on so many levels.</p>

<h2 id="step-one">Step One</h2>

<p><img src="/images/tss-first.gif" alt="First form" /></p>

<p>I was first presented with the rather humble request of entering my e-mail address, nothing un-expected here and to be honest, quite refreshing in its simplicity. I thought I may just receive an e-mail with a pre-generated password and that’d be it… but it wasn’t to be.</p>

<h2 id="step-two">Step Two</h2>

<p><img src="/images/tss-second.gif" alt="Second form" /></p>

<p>Next was a list of ten check boxes for various newsletters I could subscribe to. I don’t know how many people actually use these “features” of registration forms, but I just wanted to register. If I wanted to receive newsletters I would opt-in from within my account once registered. In their defence, the checkboxes did at least default to false!</p>

<blockquote>
  <p>On a side note, how is it not understood that you should give the user as little to deal with as possible? Especially when you’re trying to get them to sign-up to your services, you should get them in as quickly as possible, no fuss, no mess and people won’t lose interest.</p>
</blockquote>

<h2 id="step-three">Step Three</h2>

<p><img src="/images/tss-third.gif" alt="Third form" /></p>

<p>This one is a whopper, scarily so. Baring in mind that all I want to do is make one post on their forum, this seems a tad excessive.</p>

<p>Firstly they want my first and last name, fair enough but I’d say even just my name, singular, would suffice. Next are my Company Name and my Title at said company, followed by my full address, postal code, telephone number and fax number. These are a bit odd, especially considering I might be unemployed and/or unwilling to disclose such information.</p>

<p>Based on what the next sections were, <a href="http://www.theserverside.net">The Server Side</a> are seriously interested in <strong>my</strong> company. They’re asking such in-depth questions as what my IT budget is, how many employees are at the company, how many of those are developers, the purchasing scope and the industry of my organisation. Woah. Who even knows that stuff? Never mind wants to disclose it.</p>

<p>Finally I get to choose which technologies are relevant to me, via another big list of checkboxes.</p>

<p>As if that huge list wasn’t bad enough, to put the proverbial icing on the cake, 90% of the fields are <strong>mandatory</strong>! Yes, even the IT Budget and Purchasing Scope. Absolute madness!</p>

<h2 id="step-four">Step Four</h2>

<p><img src="/images/tss-fourth.gif" alt="Fourth form" /></p>

<p>Yes, there’s more. This is merely a finalisation of my e-mail and a password. Nothing fancy.</p>

<h2 id="the-end">The End</h2>

<p>When I encountered step three, all I thought of was targeted advertising; something I definitely do not want to be a part of. I’m shocked to be honest, it’s a sad state of affairs when so much information needs to be gathered just to allow simple forum/comment posting.</p>

<p>I didn’t make it past the form - The Server Side has lost my gems of wisdom.</p>

 <a class="read-more" href="/writings/your-forms-are-killing-me">Read more &raquo;</a>
        </section>
        <footer class="post-meta">
            
            
            <time class="post-date" datetime="2006-06-29">
                29 Jun 2006
            </time>
        </footer>
    </article>

    

    <article class="post">
        <header class="post-header">
            <h2 class="post-title"><a href="/writings/using-ies-conditional-comments-for-targeted-javascript">Using Internet Explorer's conditional comments for targeted JavaScript</a></h2>
        </header>
        <section class="post-excerpt">
            <p>The <a href="http://blogs.msdn.com/ie/archive/2005/10/12/480242.aspx">demise of CSS hacks</a>, something which has been covered elsewhere to no end, definitely a good thing, but not what I’m covering here - not directly anyway. I’ve been wondering if we can take advantage of this new age of “hack segregation”.</p>

<p>The way I see it is we’re already breaking the rule of separation by using conditional comments in the structure, so why don’t we cease this opportunity to save our friends (users of Firefox, Safari, Opera etc…) some bandwidth by providing IE specific JavaScript in the same way too?</p>

<p>For those wondering what I could mean by “IE specific JavaScript”, an example would be simulating the CSS focus pseudo class on form elements - something highly recommended for an accessible and usable form - which aren’t implemented in the market standard versions of Internet Explorer (6 and below).</p>

<p>I don’t think users of compliant browsers should be punished by downloading extraneous scripts, loading events into the queue and then spending time evaluating code that doesn’t even apply to them.</p>

<p>I’m proposing that we devote a section of the page <code>head</code> tag to Internet Explorer, that’s simply a conditional comment section that contains any style sheets and script blocks that only apply to IE.</p>

<h2 id="example-1-what-we-are-doing">Example 1 (what we are doing)</h2>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c">&lt;!--[if lt IE 7]&gt;
&lt;link rel="stylesheet" type="text/css" href="/css/ie-specific.css" /&gt;
&lt;![endif]--&gt;</span>
<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span> <span class="na">src=</span><span class="s">"/js/ie-specific.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
  <span class="nx">addEvent</span><span class="p">(</span><span class="nb">window</span><span class="p">,</span> <span class="s1">'load'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="k">if</span> <span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">all</span><span class="p">)</span> <span class="p">{</span> <span class="nx">doIEStuff</span><span class="p">();</span> <span class="p">});</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre>
</div>

<h2 id="example-2-what-we-could-be-doing">Example 2 (what we could be doing)</h2>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c">&lt;!--[if lt IE 7]&gt;
&lt;link rel="stylesheet" type="text/css" href="/css/ie-specific.css" /&gt;
&lt;script type="text/javascript" src="/js/ie-specific.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript"&gt;
  addEvent(window, 'load', doIEStuff);
&lt;/script&gt;
&lt;![endif]--&gt;</span>
</code></pre>
</div>

<p>In <em>Example 1</em> only Internet Explorer (prior to version 7) will download the stylesheet, but all browsers download the “ie-specific.js” JavaScript file and evaluate the <code>addEvent</code> code block. However if we follow <em>Example 2</em>, Internet Explorer will download the JavaScript and CSS just like normal, but other browsers simply see the whole section as a standard html comment and thus won’t download anything or evaluate the code block.</p>

<p>Wonderful, eh? I feel more comfortable with this approach than using questionable browser detection methods in JavaScript and it also reinforces (by just a tiny little bit) that compliant browsers are faster than their non-compliant brethren.</p>

 <a class="read-more" href="/writings/using-ies-conditional-comments-for-targeted-javascript">Read more &raquo;</a>
        </section>
        <footer class="post-meta">
            
            
            <time class="post-date" datetime="2006-06-15">
                15 Jun 2006
            </time>
        </footer>
    </article>

    

    <article class="post">
        <header class="post-header">
            <h2 class="post-title"><a href="/writings/bloated-forms">Bloated forms</a></h2>
        </header>
        <section class="post-excerpt">
            <p>I don’t know what it is, but there seems to be an inherent urge of web developers (or designers, managers or whomever) to create forms that are hugely bloated and pointless, even for simple things such as sending a contact e-mail.</p>

<p>This fascination with bloated forms is incomprehensible to me, I just can’t understand why anybody would want to know the gender or official title of somebody who’s simply trying to say “Hello”; it’s irrelevant, all I personally care about is what they’ve got to say. Is it supposed to portray the company in an intelligent, professional manner? (<em>These people want my title, they obviously mean business!</em>) I don’t know, but it needs to stop.</p>

<p>I personally am a lot less inclined to fill out a form if it feels like an interrogation. Contact forms should consist of me entering my name, some form of contact information and my brain-dump - nothing else!</p>

<h2 id="fairly-standard-form">Fairly standard form</h2>

<p><img src="/images/form-bad.png" alt="Bad form layout" /></p>

<h2 id="suggested-form">Suggested form</h2>

<p><img src="/images/form-good.png" alt="Good form layout" /></p>

<p>I know which one I’d prefer.</p>

 <a class="read-more" href="/writings/bloated-forms">Read more &raquo;</a>
        </section>
        <footer class="post-meta">
            
            
            <time class="post-date" datetime="2006-06-15">
                15 Jun 2006
            </time>
        </footer>
    </article>

    

    <article class="post">
        <header class="post-header">
            <h2 class="post-title"><a href="/writings/amusing-quotrecommend-a-friendquot-usage">Amusing "Recommend a Friend" usage</a></h2>
        </header>
        <section class="post-excerpt">
            <p>We’ve been sending out a (rather successful) e-mail campaign for <a href="http://www.swiftleisure.co.uk">Swift</a> over the past few days, a good experience and definitely an eye opener. Something that amused me over the course of the project was the way people were using the “Recommend a Friend” feature of the e-mail.</p>

<p>If you’re presented by a form, which asks for your friends name, e-mail address and some form of comment from yourself, what would you put in the name field? Common sense says that you should put their full name in, as generally that’s what people want; not these people though! Over 50% of the recommendations were supplied with first names only or nicknames - the most wonderful being “MUM”; yes, block capitals too.</p>

<p>So we have a nice collection of recommendations along the lines of:</p>
<ol>
	<li>George</li>
	<li>Sally</li>
	<li>Geoff</li>
	<li>liz</li>
	<li>MUM</li>
</ol>
<p>How very helpful.</p>

<p>They’ll love the targeted e-mails they’re bound to receive too; “Dear MUM, we think…”.</p>

 <a class="read-more" href="/writings/amusing-quotrecommend-a-friendquot-usage">Read more &raquo;</a>
        </section>
        <footer class="post-meta">
            
            
            <time class="post-date" datetime="2006-06-15">
                15 Jun 2006
            </time>
        </footer>
    </article>

    

    <article class="post">
        <header class="post-header">
            <h2 class="post-title"><a href="/writings/sql-server-object-exists-function">SQL Server Object Exists Function</a></h2>
        </header>
        <section class="post-excerpt">
            <blockquote>
  <p><strong>Update:</strong> Added separate versions for SQL Server 2000 and SQL Server 2005, due to the differences in the system objects tables.It may just be me, but when writing migration/create scripts for use with SQL Server I get quite agitated at having to write an ugly, long-winded, drop statement at the start of every object definition.</p>
</blockquote>

<p>The support for dropping objects is one of the few things I would say MySQL has SQL Server over the barrel for.Baring in mind that if you try to drop an object that doesn’t exist, you’ll get an execution error; here’s how to drop a table in MySQL:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">DROP</span> <span class="k">TABLE</span> <span class="n">IF</span> <span class="k">EXISTS</span> <span class="n">customers</span>
</code></pre>
</div>

<p>Here’s how to drop the same table, if you’re using SQL Server:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">IF</span> <span class="k">EXISTS</span><span class="p">(</span><span class="k">SELECT</span> <span class="mi">1</span> <span class="k">FROM</span> <span class="n">sys</span><span class="p">.</span><span class="n">objects</span> <span class="k">WHERE</span> <span class="n">OBJECT_ID</span> <span class="o">=</span> <span class="n">OBJECT_ID</span><span class="p">(</span><span class="n">N</span><span class="s1">'customers'</span><span class="p">)</span> <span class="k">AND</span> <span class="k">type</span> <span class="o">=</span> <span class="p">(</span><span class="n">N</span><span class="s1">'U'</span><span class="p">))</span>    <span class="k">DROP</span> <span class="k">TABLE</span> <span class="n">customers</span>
</code></pre>
</div>

<p>As always, when something annoys you enough and you’re in the middle of something else, it’s about time you wrote that solution. So I’ve created a simple user-defined function that checks if an object exists then returns a <code>BIT 0</code> or <code>1</code> depending.</p>

<p>To use the function, all you have to do is call <code>dbo.ObjectExists</code> with two parameters, the first being the name of the object you want to check on, the second being the type of object.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">IF</span> <span class="n">dbo</span><span class="p">.</span><span class="n">ObjectExists</span><span class="p">(</span><span class="s1">'customers'</span><span class="p">,</span> <span class="s1">'U'</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">DROP</span> <span class="k">TABLE</span> <span class="n">customers</span>
</code></pre>
</div>

<dl>
  <dt>Common Object Types:</dt>
  <dd>
    <p><code>P</code> - Stored Procedure&lt;/dd&gt;</p>
    <dd>
      <p><code>U</code> - User Table&lt;/dd&gt;</p>
      <dd>
        <p><code>FN</code> - User-Defined Function&lt;/dd&gt;
&lt;/dl&gt;</p>

        <p>Thanks to this little function, you can now almost match the simplicity of MySQL.</p>

        <h2 id="and-now-the-code">…and now the code</h2>

        <h3 id="sql-server-2000">SQL Server 2000</h3>

        <div class="highlighter-rouge"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">FUNCTION</span> <span class="n">dbo</span><span class="p">.</span><span class="n">ObjectExists</span><span class="p">(</span><span class="o">@</span><span class="k">Object</span> <span class="n">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="o">@</span><span class="k">Type</span> <span class="n">VARCHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">RETURNS</span> <span class="n">BIT</span>
<span class="k">AS</span>
<span class="k">BEGIN</span>
  <span class="k">DECLARE</span> <span class="o">@</span><span class="k">Exists</span> <span class="n">BIT</span>
  <span class="n">IF</span> <span class="k">EXISTS</span><span class="p">(</span><span class="k">SELECT</span> <span class="mi">1</span> <span class="k">FROM</span> <span class="n">dbo</span><span class="p">.</span><span class="n">sysobjects</span> <span class="k">WHERE</span> <span class="p">[</span><span class="n">ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">OBJECT_ID</span><span class="p">(</span><span class="o">@</span><span class="k">Object</span><span class="p">)</span> <span class="k">AND</span> <span class="k">type</span> <span class="o">=</span> <span class="p">(</span><span class="o">@</span><span class="k">Type</span><span class="p">))</span>
    <span class="k">SET</span> <span class="o">@</span><span class="k">Exists</span> <span class="o">=</span> <span class="mi">1</span>
  <span class="k">ELSE</span>
    <span class="k">SET</span> <span class="o">@</span><span class="k">Exists</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">RETURN</span> <span class="o">@</span><span class="k">Exists</span>
<span class="k">END</span>
</code></pre>
        </div>

        <h3 id="sql-server-2005">SQL Server 2005</h3>

        <div class="highlighter-rouge"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">FUNCTION</span> <span class="n">dbo</span><span class="p">.</span><span class="n">ObjectExists</span><span class="p">(</span><span class="o">@</span><span class="k">Object</span> <span class="n">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="o">@</span><span class="k">Type</span> <span class="n">VARCHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">RETURNS</span> <span class="n">BIT</span>
<span class="k">AS</span>
<span class="k">BEGIN</span>
  <span class="k">DECLARE</span> <span class="o">@</span><span class="k">Exists</span> <span class="n">BIT</span>
  <span class="n">IF</span> <span class="k">EXISTS</span><span class="p">(</span><span class="k">SELECT</span> <span class="mi">1</span> <span class="k">FROM</span> <span class="n">sys</span><span class="p">.</span><span class="n">objects</span> <span class="k">WHERE</span> <span class="n">object_id</span> <span class="o">=</span> <span class="n">OBJECT_ID</span><span class="p">(</span><span class="o">@</span><span class="k">Object</span><span class="p">)</span> <span class="k">AND</span> <span class="k">type</span> <span class="o">=</span> <span class="p">(</span><span class="o">@</span><span class="k">Type</span><span class="p">))</span>
    <span class="k">SET</span> <span class="o">@</span><span class="k">Exists</span> <span class="o">=</span> <span class="mi">1</span>
  <span class="k">ELSE</span>
    <span class="k">SET</span> <span class="o">@</span><span class="k">Exists</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">RETURN</span> <span class="o">@</span><span class="k">Exists</span>
<span class="k">END</span>
</code></pre>
        </div>

      </dd>
    </dd>
  </dd>
</dl>
 <a class="read-more" href="/writings/sql-server-object-exists-function">Read more &raquo;</a>
        </section>
        <footer class="post-meta">
            
            
            <time class="post-date" datetime="2006-05-26">
                26 May 2006
            </time>
        </footer>
    </article>

    

    <nav class="pagination" role="pagination">
    
        
            <a class="newer-posts" href="/page15/" title="Previous Page">&laquo; Newer Posts</a>
      
    
    <span class="page-number"> Page 16 of 23 </span>
     
        <a class="older-posts" href="/page17/" title="Next Page">Older Posts &raquo;</a>
     
</nav>

</main>

    <footer class="site-footer clearfix">
      <section class="copyright">
        <a href="mailto:james@jagregory.com">James Gregory</a> &copy;
               &bull; All content licensed under <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">cc by-nc-sa 4.0</a>.
      </section>
    </footer>

    <script type="text/javascript" src="/js/jquery-1.11.1.min.js"></script>
    <script type="text/javascript" src="/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="/js/index.js"></script>
</body>
</html>
