
<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <title>James Gregory</title>
    <meta name="author" content="James Gregory">

    
    <meta name="description" content="AJAX and Security I’ve been creating a content management system over the past few weeks with all the bells and whistles you’d expect from a new web &hellip;">
    
    <meta name="viewport" content="width=device-width; initial-scale=1; maximum-scale=1">

    <link href="/atom.xml" rel="alternate" title="James Gregory" type="application/atom+xml">
    <link rel="canonical" href="">
    <link href="/favicon.png" rel="shortcut icon">
    <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
    <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    
    
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-3186192-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body>
	<header class="inner"><h1 class="left"><a href="/">James Gregory</a></h1>
<nav class="menu left"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
</ul>
</nav>
<div class="right">
	<form class="search right" action="http://google.com/search" method="get">
		<input class="left" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:www.jagregory.com">
	</form>
	<div class="social right">
		
		
		
		
		<a class="github" href="https://github.com/jagregory" title="GitHub">GitHub</a>
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
	</div>
</div>

</header>
	
	<div id="content" class="inner">


    <article class="post">
    <h1 class="title"><a href="/writings/ajax-and-security/">AJAX and Security</a></h1>
    <div class="entry">
        <p>I’ve been creating a content management system over the past few weeks with all the bells and whistles you’d expect from a new web project. One thing that has caught my eye is the potential security risk when using AJAX.</p>

<p>For said project I’ve been using the <a href="http://ajax.schwarz-interactive.de/csharpsample/default.aspx">Ajax.Net library</a> which, like most others, outputs wrapped calls to a server-side functions in javascript.</p>

<p>With that in mind then, surely anyone can open up the rendered source, see your methods and then execute them at will, potentially causing havoc. Initially I was using Ajax for most of my interaction with the server - something which seems pointless in hindsight. This meant that I had a create user function exposed to the public, potentially anyone could create themselves an account within the system by using the Javascript. This isn’t much of a problem from within the context of this project, because you can only ever view the page with the javascript when you’re authorised to create users; so it doesn’t make any difference. If this was public though, it could be a serious security risk. An example could be a comment form on a blog post, if you expose the method of creating a new comment through javascript then someone, with a little bit of work, could use the javascript to post automated comments.</p>

<p>Once again, nothing major but I think it is definitely something you should bare in mind when creating your pages. I guess the moral of this little story is don’t use Ajax for the sake of it and if you do use it make sure that the functions you are calling are harmless. Anything dealing with security should be left to post-backs but user experience improving features are fine - auto complete text boxes for example.</p>

        
        
    </div>
    <div class="meta">
        <div class="date">








  


<time datetime="2006-01-10T00:00:00+11:00" pubdate data-updated="true">Jan 10<span>th</span>, 2006</time></div>
        <div class="tags">

</div>
        
    </div>
</article>


    <article class="post">
    <h1 class="title"><a href="/writings/prototype-periodicalexecuter-stop-javascript-function/">Prototype PeriodicalExecuter.stop() JavaScript Function</a></h1>
    <div class="entry">
        <p>Download: <a href="#" title="Prototype extensions javascript file">prototype-extensions.js</a>. <em>(this download is no longer available, sorry)</em></p>

<p>I’ve been playing with the <a href="http://prototype.conio.net/">prototype framework</a> for a while now and am very impressed, the file size is a bit of a down point but that aside it’s excellent.</p>

<p>The one thing that has slightly irritated me (and <a href="http://roberthanson.blogspot.com/2005/11/prototypejs-periodicalexecuter.html" title=" Robert Hanson's Blog">others it seems</a>) is that there isn’t a stop function built into the PeriodicalExecuter object. Seems something strangly simple to miss out, especially as the Ajax.PeriodicalUpdater has one built in. With that in mind I’ve made an extension my self to perform this function.</p>

<p>I’ve simply placed the following code in a <a href="http://www.jagregory.com/downloads/prototype-extensions.js" title="Prototype extensions javascript file">prototype-extensions.js</a> file and referenced it wherever needed.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">PeriodicalExecuter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">registerCallback</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nx">intervalID</span> <span class="o">=</span> <span class="nx">setInterval</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">onTimerEvent</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">),</span> <span class="k">this</span><span class="p">.</span><span class="nx">frequency</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="nx">PeriodicalExecuter</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">stop</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">clearInterval</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">intervalID</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>There’s really nothing much going on in this code, all it does is take the current registerCallback function (which creates the actual timer) and stores its returned interval ID which we then use in the new stop function with the native clearInterval method.</p>

<p>Here’s an example implementation where I fire the PeriodicalExecuter when a key is released in a text box and then stop it once the call completes, this was the main reason I created this extension, my aim was to have a waiting period of a few seconds before a ajax lookup is performed; mainly to cut down on server calls. Each time the textbox changes the PeriodicalExecuter gets reset and started again which means the function will only ever fire once the countdown is complete.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">id=</span><span class="s">&quot;changer&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">pe</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;changer&#39;</span><span class="p">).</span><span class="nx">onkeyup</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">pe</span><span class="p">)</span> <span class="nx">pe</span><span class="p">.</span><span class="nx">stop</span><span class="p">();</span>
</span><span class='line'>    <span class="nx">pe</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PeriodicalExecuter</span><span class="p">(</span><span class="nx">textChange</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">textChange</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;check textbox content against database here&#39;</span><span class="p">);</span>
</span><span class='line'>    <span class="nx">pe</span><span class="p">.</span><span class="nx">stop</span><span class="p">();</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="nt">&lt;/script&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>I’m sure this method of extension is probably frowned upon from within the community and changes are expected to be submitted for the actual library, but I needed a fix asap and I’m sure a few other people might too.</p>

        
        
    </div>
    <div class="meta">
        <div class="date">








  


<time datetime="2006-01-09T00:00:00+11:00" pubdate data-updated="true">Jan 9<span>th</span>, 2006</time></div>
        <div class="tags">

</div>
        
    </div>
</article>


    <article class="post">
    <h1 class="title"><a href="/writings/nested-datagridrepeater-with-key-value-access/">Nested DataGrid/Repeater With Key Value Access</a></h1>
    <div class="entry">
        <p>One of my colleagues was having a problem with a datagrid nested in a repeater. We’ve done this kind of thing before with no problems, but this time the dataset wasn’t allowing key access to columns (i.e <code>Container.DataItem("ID")</code>). We toiled for quite some time trying to figure out why, with no avail. Eventually we just ended up using the direct index of the column; which worked fine as long as we didn’t change the column ordering.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='aspx-vb'><span class='line'><span class="nt">&lt;asp:Repeater</span> <span class="na">id=</span><span class="s">&quot;rptLogins&quot;</span> <span class="na">Runat=</span><span class="s">&quot;server&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;ItemTemplate&gt;</span>
</span><span class='line'>    <span class="nt">&lt;%#</span> <span class="n">DataBinder</span><span class="p">.</span><span class="n">Eval</span><span class="p">(</span><span class="n">Container</span><span class="p">,</span> <span class="s">&quot;DataItem.Password&quot;</span><span class="p">)</span> <span class="nt">%&gt;</span>
</span><span class='line'>
</span><span class='line'>    <span class="nt">&lt;asp:DataGrid</span> <span class="na">id=</span><span class="s">&quot;dgUsageDetail&quot;</span> <span class="na">Runat=</span><span class="s">&quot;server&quot;</span> <span class="na">DataSource=</span><span class="s">&#39;%# Container.DataItem.Row.GetChildRows(&quot;myRelation&quot;) %&gt;&#39;</span> <span class="na">AutoGenerateColumns=</span><span class="s">&quot;false&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>      <span class="nt">&lt;Columns&gt;</span>
</span><span class='line'>        <span class="nt">&lt;asp:TemplateColumn</span> <span class="na">HeaderText=</span><span class="s">&quot;Date&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>          <span class="nt">&lt;ItemTemplate&gt;&lt;%#</span> <span class="n">DataBinder</span><span class="p">.</span><span class="n">Eval</span><span class="p">(</span><span class="n">Container</span><span class="p">,</span> <span class="s">&quot;DataItem(1)&quot;</span><span class="p">,</span> <span class="s">&quot;{0:dd/MM/yyyy}&quot;</span><span class="p">)</span> <span class="nt">%&gt;&lt;/ItemTemplate&gt;</span>
</span><span class='line'>        <span class="nt">&lt;/asp:TemplateColumn&gt;</span>
</span><span class='line'>        <span class="nt">&lt;asp:TemplateColumn</span> <span class="na">HeaderText=</span><span class="s">&quot;Time&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>          <span class="nt">&lt;ItemTemplate&gt;&lt;%#</span> <span class="n">DataBinder</span><span class="p">.</span><span class="n">Eval</span><span class="p">(</span><span class="n">Container</span><span class="p">,</span> <span class="s">&quot;DataItem(1)&quot;</span><span class="p">,</span> <span class="s">&quot;{0:T}&quot;</span><span class="p">)</span> <span class="nt">%&gt;&lt;/ItemTemplate&gt;</span>
</span><span class='line'>        <span class="nt">&lt;/asp:TemplateColumn&gt;</span>
</span><span class='line'>        <span class="nt">&lt;asp:TemplateColumn</span> <span class="na">HeaderText=</span><span class="s">&quot;Page Visited&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>          <span class="nt">&lt;ItemTemplate&gt;&lt;%#</span> <span class="n">Container</span><span class="p">.</span><span class="n">DataItem</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="nt">%&gt;&lt;/ItemTemplate&gt;</span>
</span><span class='line'>        <span class="nt">&lt;/asp:TemplateColumn&gt;</span>
</span><span class='line'>      <span class="nt">&lt;/Columns&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/asp:DataGrid&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/ItemTemplate&gt;</span>
</span><span class='line'><span class="nt">&lt;/asp:Repeater&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>I was never happy with this solution, for the above reason. In my opinion if you’re referencing columns you should never, ever reference them by index because it’s making your code reliant on the physical structure of the database. Something you may not have any control over what-so-ever.</p>

<p>Anyway, just now I was working on my own little project (…on my lunch) and I needed to do the same thing; perfect time for some investigation. If you look at the DataSource of the above nested datagrid you’ll see it’s bound to the current rows <code>GetChildRows</code> method, ends up (fairly obviously in hind sight) this returns a simple 1-dimensional array of DataRow objects. These DataRow objects (to my knowledge) basically contain an internal array of values, these values map to their parents <code>Columns</code> collection. There’s no reference to the actual name of the column, hence why the key access doesn’t work.</p>

<p>The solution is quite simple. So simple it’s unbelievable… Replace <code>Row.GetChildRows("myRelation")</code> with <code>Row.CreateChildView("myRelation")</code>. This creates a DataView object of the child rows, so essentially it’s a mini-dataset for you to deal with as if it were standard. Keyed referencing is back in action!</p>

<blockquote><p>Note: For those that are wondering, a dataview isn’t actually a mini-dataset but a filtered view of its parent dataset.</p></blockquote>

        
        
    </div>
    <div class="meta">
        <div class="date">








  


<time datetime="2005-10-20T00:00:00+10:00" pubdate data-updated="true">Oct 20<span>th</span>, 2005</time></div>
        <div class="tags">

</div>
        
    </div>
</article>


    <article class="post">
    <h1 class="title"><a href="/writings/sql-server-exists-function-quicker-than-count/">SQL Server: Exists() Function Quicker Than Count()</a></h1>
    <div class="entry">
        <p>You&#8217;ve seen the title; it&#8217;s true.</p>

<p>I&#8217;ve been running an &#8220;administration&#8221; query to modify a table with around 190,000 records in. This table, segments, contains a status column called Coded. This value is derived from another table, faults. If any faults belonging to a segment has a coded status of 0 then the segment coded value is also 0.</p>

<p>My query did an update on each row in the segments table, retrieving a <code>count</code> of how many faults there are with a coded status of <code>0</code> that belong to the current segment. If the <code>count</code> is greater than <code>0</code> then the segment coded is set to <code>0</code>, otherwise to <code>1</code>.</p>

<p>It ran for over 2 hours without any sign of finishing.</p>

<p>I changed the query to do a simple case statement with an <code>exists</code> on the faults table where <code>Coded = 0</code> and it’s just finished in 4 minutes. Unbelievable.</p>

<h3>Update</h3>

<p>I thought I should give a bit of an explanation as to why this is happening. It basically all boils down to the way the two functions operate that makes the biggest difference. A <code>count</code> statement counts every row that matches the where statement, so even if you only need to know about one record (like in my case) it’ll still read every other row too. On the other hand the <code>exists</code> function will return as soon as its conditions are met, so if the first row it finds matches it’ll only read one row.</p>

        
        
    </div>
    <div class="meta">
        <div class="date">








  


<time datetime="2005-09-22T00:00:00+10:00" pubdate data-updated="true">Sep 22<span>nd</span>, 2005</time></div>
        <div class="tags">

</div>
        
    </div>
</article>


    <article class="post">
    <h1 class="title"><a href="/writings/datediff-minus-one-visualbasic-assembly/">DateDiff() Minus One VisualBasic Assembly</a></h1>
    <div class="entry">
        <p>I&#8217;m not a big fan of using the <code>Microsoft.VisualBasic</code> assembly, I avoid it at all costs basically.</p>

<p>As we all know, the visual basic assembly comes with a large collection of built-in functions one of which is the <code>DateDiff</code> function. This takes two dates and a comparison value (e.g. <code>d</code> for day) and then spits out the difference.</p>

<p>Here’s the same thing just minus the visual basic usage:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="n">DateTime</span> <span class="n">firstDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">Now</span><span class="p">;</span>
</span><span class='line'><span class="n">DateTime</span> <span class="n">secondDate</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DateTime</span><span class="p">(</span><span class="m">2005</span><span class="p">,</span> <span class="m">8</span><span class="p">,</span> <span class="m">20</span><span class="p">);</span>
</span><span class='line'><span class="n">TimeSpan</span> <span class="n">difference</span> <span class="p">=</span> <span class="n">secondDate</span><span class="p">.</span><span class="n">Subtract</span><span class="p">(</span><span class="n">firstDate</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// days: difference.Days</span>
</span></code></pre></td></tr></table></div></figure>


        
        
    </div>
    <div class="meta">
        <div class="date">








  


<time datetime="2005-09-16T00:00:00+10:00" pubdate data-updated="true">Sep 16<span>th</span>, 2005</time></div>
        <div class="tags">

</div>
        
    </div>
</article>


    <article class="post">
    <h1 class="title"><a href="/writings/launching-woes/">Launching Woes</a></h1>
    <div class="entry">
        <p>Launch problems, they always occur. Yesterday (1st September) was no exception, we launched this years Swift Leisure website; a bloody huge site. As soon as it got up there it fell over, which was unfortunate. After some investigation we narrowed it down to the Url Rewriter that we have in place (unfortunately, solely my work!).</p>

<p>The big problem with it was that it replaces the Request.ApplicationPath in any requested path with a blank string to remove any unnecessary parts of the path; <code>SwiftLeisure2006/Caravans/Abbey</code> became <code>Caravans/Abbey</code>. This worked fine on our local setup but we didn’t account for possible changes in the <code>Request.ApplicationPath</code> when the site is situated directly in the root instead of a sub-folder. The <code>Request.ApplicationPath</code> became just <code>/</code> which means <code>/Caravans/Abbey</code> became <code>CaravansAbbey</code> instead of <code>Caravans/Abbey</code>. Simple fix once we figured this out and found any similar sections throughout our controls.</p>

<p>Live and learn, live and learn.</p>

        
        
    </div>
    <div class="meta">
        <div class="date">








  


<time datetime="2005-09-02T00:00:00+10:00" pubdate data-updated="true">Sep 2<span>nd</span>, 2005</time></div>
        <div class="tags">

</div>
        
    </div>
</article>


    <article class="post">
    <h1 class="title"><a href="/writings/accessibility-standards-and-my-say/">Accessibility, Standards and My Say</a></h1>
    <div class="entry">
        <p>The web has come a long way in the past few years, but it is still hindered greatly by the methodology of the “previous generation” of web-designers. People are still designing with the mentality of serving everyone with a page that is specifically tailored to suit their particular browser and operating system. While this did get the job done originally, it was most certainly a lot more work than it needed to be. That’s why I find the idea of generating one (and only one) document to serve all users very interesting. Most browsers are conforming to standards in some way shape or form, the majority support CSS2 and XHTML 1.1 and the ones that don’t (mostly) degrade gracefully. It’s no longer about serving a page that is pixel perfect on every system; it’s about making sure all users get a good experience from your site.</p>

<p>Another branch of this takes the form of Accessibility. Accessibility has recently been highlighted by governments as a priority for websites; the US and UK both have their own take on the situation with relating laws and amendments. It basically boils down to any website that is providing a service should have a bare minimum of accessibility; otherwise they are discriminating against their less able customers. This means businesses are required, by law, to provide for all their customers (whether or not they have disabilities). Just as you would expect a shop to provide wheelchair ramps for disabled shoppers, you should expect pages to be designed to aid disabled web-users.</p>

<p>Recently I equipped my self with a screen-reader (<a href="http://www.freedomscientific.com/fs_products/software_jaws.asp" title="JAWS Screen Reader">JAWS</a>) and was appalled — but not particularly shocked — at the amount of sites that are simply unusable with anything other than a standard browser. Most pages are so full of invalid markup that the screen-readers simply mumble on continuously and any actual content is undecipherable. If websites complied to the standards then their experience would be tolerable at the very least. Unfortunately the majority of website designers simply do not know (or often care) about creating accessible pages.</p>

<p><span class="note">
Note: Screen-readers, for those that don’t know, take a web page and read it out using a synthesised voice. A perfectly accessible site would read the same as a printed document.
</span></p>

<p>One of the largest problems with the way pages have been designed in the past has been using the supplied tags for their appearance rather than their actual purpose. The <code>&lt;b&gt;</code> tags have been used to create bold headings, the <code>&lt;font&gt;</code> tags used to change styles of fonts and worst of all the <code>&lt;table&gt;</code> tags for layout. This means when a screen reader parses these pages it emphasises the wrong words and spouts nonsense when encountering these convoluted tags. What a properly designed page would have is a distinct separation of content and layout, of HTML and CSS. The HTML document should use be structured like a standard plain text print document; with appropriate headings, sub-headings, lists and paragraphs. These tags can then be styled using CSS to any manner to which they like. So when a screen reader encounters this page it reads the unstyled version; a perfectly formed document.</p>

<p>That’s the end of my little rant, maybe together we learned something.</p>

        
        
    </div>
    <div class="meta">
        <div class="date">








  


<time datetime="2005-07-27T00:00:00+10:00" pubdate data-updated="true">Jul 27<span>th</span>, 2005</time></div>
        <div class="tags">

</div>
        
    </div>
</article>


    <article class="post">
    <h1 class="title"><a href="/writings/error-logging-modules-ampamp-handlers-elmah/">ELMAH: Error Logging Modules & Handlers</a></h1>
    <div class="entry">
        <p>In my previous post I talked about my exception logging system that I laid to rest. Fortunately for me that doesn’t mean my applications are logless, quite the contrary. I’ll explain…</p>

<p>When I came to terms with my logging system being inadequate and hard to maintain, I began looking for a replacement. To my delight I came across <a href="http://www.raboof.com/Projects/Elmah/Elmah.aspx"><acronym title="Error Logging Modules &amp; Handlers">ELMAH</acronym></a>  written by <a href="http://www.raboof.com">Atif Aziz</a>. <acronym title="Error Logging Modules &amp; Handlers">ELMAH</acronym> is basically a couple of HttpModules and a HttpHandler that intercept any unhandled exceptions from within your application and log them. This is where the fun begins…</p>

<p>You can download/create extensions that enable you to save your logs to wherever takes your fancy. There is a SQL Server writer, an XML file writer and I believe an MySql writer too. I’m currently using the XML writer simply because connecting to the SqlServer may be one of the possible exceptions raised. I’ve been running ELMAH now for 2 weeks and have had no issues at all; especially no write-permission related ones!</p>

<p>This <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnaspp/html/elmah.asp" title="Using HTTP Modules and Handlers to Create Pluggable ASP.NET Components">MSDN Article</a> by <a href="http://www.4guysfromrolla.com/ScottMitchell.shtml">Scott Mitchell</a> was my manual for setting up ELMAH, not that it was hard. That article can explain it much better than I every could.</p>

<p>Once you’ve got it all set up and assigned a location to the HttpHandler, you can navigate there and be presented with a log viewer. Details of the exception and even the actual yellow screen that occurred too (through a dump of the html) can be accessed though that screen. The thing that got me really interested was the ability to subscribe to an RSS feed of your log! Now I no longer have to spend 40 minutes on the phone trying to decipher what really happened when the client claims they “didn’t touch a thing, it just crashed on its own”. All you have to do is (in your favourite feed reader) enter your log viewer path with “/rss” added to the end (e.g. http://www.mysite.com/Logs/View.aspx/rss). Then you can get all the same details as navigating to the page, without actually having to do anything! Oh yes, life is good.</p>

<p>There was one thing I had to come to terms with while setting up ELMAH. That is the fact that only unhandled exceptions will be logged, so that meant most of my try-catch blocks were causing my exceptions not to be logged. The solution to this was to remove the blocks that weren’t performing any specific function except that of gobbling up the exception and firing out a generic error message. I felt uncomfortable with this at first, as I was letting exceptions run riot but then I realised there’s not much point in handling exceptions if I can’t actually do anything to correct the error that occurred. So letting them go unhandled is probably the best cause of action (what exactly can be done if your SqlConnection won’t connect? It’s not like you can just connect to your mirrored SQL Server). So those exceptions are bubbled up to the page and then ELMAH captures and logs them. Using the customErrors section of the web.config you can present your users with a generic error page to stop them from seeing the nasty yellow screen.</p>

<p>That my friends is the general gist of ELMAH&#8230;</p>

        
        
    </div>
    <div class="meta">
        <div class="date">








  


<time datetime="2005-07-23T00:00:00+10:00" pubdate data-updated="true">Jul 23<span>rd</span>, 2005</time></div>
        <div class="tags">

</div>
        
    </div>
</article>


    <article class="post">
    <h1 class="title"><a href="/writings/exception-logging/">Exception Logging</a></h1>
    <div class="entry">
        <p>Something I’ve always been tinkering with for my ASP.Net applications has been exception logging. I often get irritated when users (or applications) supply me with misleading or incorrect error messages, or at least incorrect directions of how to recreate the error.</p>

<p>I worked for quite some time trying to create a Logging system that would cater for my needs, and I got quite close to doing that. I created a small go-between object for the Trace and Debug logging and wrote that to my own XML file. The idea behind it, of course, was to make it easier for my self in debugging problems, if I could supply my self with all the data that I know I would require to trace an issue then, in theory, I could correct it much more quickly. This took me quite some time to create and of course was not perfect.</p>

<p>There were a few major (a.k.a. Huge) issues with my system, firstly the logger would only interact with your code wherever you explicitly told it to. Basically you had to write extra code wherever you wanted to log an exception. This was neither friendly nor desirable. The next issue was access rights for the XML files; this reared its head in a few shapes and forms. One of the instances didn’t occur very often but was a pain when it did; the writer was rejected write access due to another instance of itself actually writing to the file. I remedied this by making the writer wait until the other was done; this of course had performance implications though, having to stop everything within a page while the log writer sits idle. The other time it was an issue was whenever I wanted to archive the logs I had to wait until no other instances were accessing it, this also involved waiting but it takes longer to rename a file and create a new one than it does to simply amend a file.</p>

<p>The problem of having to explicitly declare any usage of the writer was the deciding factor in me binning my writer. Sad as it is to see something that I spent a fair amount of time creating deleted, it’s always slightly reassuring when you’re moving onto a product that is fully tested and working and also includes all source code! More on that soon though&#8230;</p>

        
        
    </div>
    <div class="meta">
        <div class="date">








  


<time datetime="2005-07-18T00:00:00+10:00" pubdate data-updated="true">Jul 18<span>th</span>, 2005</time></div>
        <div class="tags">

</div>
        
    </div>
</article>


    <article class="post">
    <h1 class="title"><a href="/writings/a-bit-of-culture/">A Bit of Culture</a></h1>
    <div class="entry">
        <p>I think this is possibly something that everyone goes through at some point in their life, the desire to be more cultured. To me and most people this means going out and buying a lot of “classic” books and giving them a good going over. If you had tried to get me to do this a few years ago there would have been no chance of it happening, but it just so happens that I’m starting to get really into reading so this is a natural extension of things.</p>

<p>I’ve got my self the following books, anybody with any suggestions feel free to drop me a comment or e-mail.</p>

<ul>
<li>Brave New World (Aldous Huxley)</li>
<li>Heart Of Darkness (Joseph Conrad)</li>
<li>Animal Farm (George Orwell)</li>
<li>Catch-22 (Joseph Heller)</li>
<li>Gulliver&#8217;s Travels (Jonathan Swift)</li>
<li>Fahrenheit 451 (Ray Bradbury)</li>
</ul>


<p>For something a little different I also got The Interpretation of Dreams by Sigmund Freud, a slight change of pace.</p>

<p>I’ve nearly finished reading Heart of Darkness, not taken long really. Not surprising considering it’s only 100 pages long, I can’t say it’s had a huge impact on me. I may be missing the point completely but nothing really seems to have happened and I’m onto the 3rd chapter (of 3). None the less the point is that I’ve now read a piece of history and have an informed opinion of it rather than just hints of what it’s about from what I’ve picked up listening to other people.</p>

        
        
    </div>
    <div class="meta">
        <div class="date">








  


<time datetime="2005-06-13T00:00:00+10:00" pubdate data-updated="true">Jun 13<span>th</span>, 2005</time></div>
        <div class="tags">

</div>
        
    </div>
</article>

<nav id="pagenavi">
    
        <a href="/blog/page/9/" class="prev">Prev</a>
    
    
        <a href="/blog/page/11/" class="next">Next</a>
    
    <a href="/blog/archives" class="center">Blog Archives</a>
</nav></div>
	<footer class="inner">Copyright &copy; 2012 James Gregory</footer>
	<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script src="/javascripts/slash.js"></script>


<script type="text/javascript">
      var disqus_shortname = 'jagregory';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



</body>
</html>