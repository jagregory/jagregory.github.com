
<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <title>James Gregory</title>
    <meta name="author" content="James Gregory">

    
    <meta name="description" content="Git&#8217;s Guts: Merging and Rebasing Cross posted to Los Techies Here we go again, explaining the internals of Git with the intention of helping &hellip;">
    
    <meta name="viewport" content="width=device-width; initial-scale=1; maximum-scale=1">

    <link href="/atom.xml" rel="alternate" title="James Gregory" type="application/atom+xml">
    <link rel="canonical" href="">
    <link href="/favicon.png" rel="shortcut icon">
    <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
    
    <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    
    
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-3186192-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body>
	<header class="inner"><h1 class="left"><a href="/">James Gregory</a></h1>
<nav class="menu left"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
</ul>
</nav>
<div class="right">
	<form class="search right" action="http://google.com/search" method="get">
		<input class="left" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:www.jagregory.com">
	</form>
	<div class="social right">
		
		
		
		
		<a class="github" href="https://github.com/jagregory" title="GitHub">GitHub</a>
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
	</div>
</div>

</header>
	
	<div id="content" class="inner">


    <article class="post">
    <h1 class="title"><a href="/writings/gits-guts-merging-and-rebasing/">Git&#8217;s Guts: Merging and Rebasing</a></h1>
    <div class="entry">
        <blockquote>Cross posted to <a href="http://www.lostechies.com/blogs/jagregory/archive/2009/11/27/git-guts-merging-and-rebasing.aspx">Los Techies</a></blockquote>




<p>Here we go again, explaining the internals of Git with the intention of helping you understand what you&#8217;re doing day-to-day. Last time I covered <a href="/writings/gits-guts-branches-head-and-fast-forwards">branches, HEAD, and fast-forwarding</a>. Today we&#8217;ll dive into the guts of merging and rebasing.</p>




<h3>Merging branches</h3>




<p>You&#8217;ve probably merged before. You do it when you want the changes from one branch in another. The principal is the same in Git as it is most other source control systems, but the implementation differs.</p>




<p>Given the following commit structure, consisting of two branches created from the same commit, each with two commits after the branching occurred.</p>


<p><img src="/images/GitGuts2_Figure1.png" alt="Figure 1" /></p>

<p>When these two branches are merged together, this is the structure that results:</p>


<p><img src="/images/GitGuts2_Figure2.png" alt="Figure 1" /></p>

<p>The top-most commit, the red one, is a new commit made by the merge; the merge commit is what reminds Git that a merge occurred next time it&#8217;s showing the history. This commit is special, as it contains multiple parent&#8217;s in it&#8217;s meta-data; these multiple parent&#8217;s allow Git to follow the two trees of commits that constituted the branches that were merged.</p>




<p>One difference in how Git handles merges compared to many other SCMs is that it preserves the commits that were made in both branches. In other systems merges are often represented as a single commit containing the squashed contents of all the commits that were made in the branch being merged in. Git doesn&#8217;t do this (by default, you can tell it to if you want), and therefore preserves all the commits just as they were made; this is quite nice, as it proves incredibly useful to be able to track the origin of changes beyond the point of a merge.</p>




<p>When you merge two branches, it&#8217;s interesting to know that none of the commits are altered in the process. Just bare this in mind for now, I&#8217;ll explain why this is good to know later.</p>




<p>After a merge, if you were to view the history, you&#8217;d see it shown like the previous example, commits in chronological order; the feature branch commits are interspersed between the master commits.</p>


<p><img src="/images/GitGuts2_Figure2.png" alt="Figure 1" /></p>

<p>Yet no commits have been altered in the merge, so how are the commits in a different order? Well, they&#8217;re not, Git&#8217;s just showing you it in the order you expect it to be in. Internally the structure is still as below:</p>


<p><img src="/images/GitGuts2_Figure3.png" alt="Figure 1" /></p>

<p>The merge commit instructs Git to walk the two trees while building the history, and it just displays the results in chronological order. This makes more sense if you recall that Git commits don&#8217;t hold differences like other SCM systems, instead they each contain a snapshot of the complete repository; while in another SCM the ordering of commits is vital &mdash; otherwise the diffs wouldn&#8217;t build a valid file &mdash; Git is able to infer order without affecting the repository contents.</p>




<p>Looking at it in commit order, you can quite easily see how Git flattens the history to be perceived as linear without ever having to touch any of the original commits.</p>




<h4>What happens if there&#8217;s a merge conflict?</h4>




<p>We&#8217;ve all dealt with conflicts in merging before. They typically happen when changes are made to the same file in two branches, in a way that cannot be easily merged (two people edit the same line, for example).</p>




<p>Git&#8217;s commit&#8217;s are immutable though, so how are the changes that you need to make to resolve these conflicts saved? Simple. The merge commit is a regular commit with some extra meta-data, and so it capable of containing changes itself; merge conflict changes are stored in the merge commit. Again, no changes necessary to the original commits.</p>




<h3>Git objects, immutability, and rewriting history</h3>




<p>A Git repository is comprised of objects. A file is a blob object with a name attached to it; if you have two files with the same content, that&#8217;s just two names to a single blob. A directory is a tree object, which is comprised of other trees and blobs. A commit is an object that references a tree object, which is the state of the repository at the time of committing.</p>




<blockquote>To read more about git objects, I&#8217;d definitely recommend you read the <a href="http://book.git-scm.com">Git community book</a>.</blockquote>




<p>Git objects are immutable. To change an object after it&#8217;s been created is impossible, you have to recreate the object with any changes made. Even operations that seem to modify objects actually don&#8217;t; <code>commit --amend</code> is a typical example, that deletes and re-creates the commit rather than actually amending it.</p>




<p>I mentioned that merges don&#8217;t rewrite history, and that it&#8217;s a good thing. Now I&#8217;ll explain why. When you rewrite history, you do so by making changes to commits that ripple up the commit tree; when this happens, it can cause complications when others merge from you. Given a series of commits, like so:</p>


<p><img src="/images/GitGuts2_Figure4.png" alt="Figure 1" /></p>

<p>You then share these commits with another user.</p>


<p><img src="/images/GitGuts2_Figure5.png" alt="Figure 1" /></p>

<p>John now has Michael&#8217;s commits in his repository; however, Michael notices he&#8217;s made a typo in the first commit message, so he amends the commit message. The change in the message requires the commit be recreated. With that first commit recreated, the second commit now has an invalid parent reference, so that commit has to be recreated with the new reference; this recreation ripples it&#8217;s way up the tree, recreating each commit with a new parent. Michael has completely rewritten his tree&#8217;s history.</p>


<p><img src="/images/GitGuts2_Figure6.png" alt="Figure 1" /></p>

<p>Notice all the commit hashes have changed in Michael&#8217;s repository, and John&#8217;s now don&#8217;t match. If Michael was then to make a new commit to his repository, and John tried to merge that change into his repository, Git would get very upset because the new commit would reference a commit that doesn&#8217;t exist in John&#8217;s repository.</p>




<p><strong>The golden rule is:</strong> rewriting history is fine as long as the commits that will be affected haven&#8217;t been made public.</p>




<h3>Rebasing</h3>




<p>The purpose of a rebase is the same as a merge, to bring two tree&#8217;s of commits together. It differs in it&#8217;s approach. Rebasing is a seriously sharp tool. Very powerful, but pretty easy to cut yourself with it.</p>




<p>When you rebase one branch onto another, Git undoes any changes you&#8217;ve made in the target branch, brings it up to date with the changes made in the source branch, then replays your commits on top. This sounds quite strange, so I&#8217;ll go over it step-by-step.</p>




<p>You start with your diverged branches:</p>


<p><img src="/images/GitGuts2_Figure7.png" alt="Figure 1" /></p>

<p>If you then rebase feature onto master, Git undoes the changes in master.</p>


<p><img src="/images/GitGuts2_Figure8.png" alt="Figure 1" /></p>

<p>The history of both branches is now the same, master has been updated to reflect feature; the new commits that were made in master are now detached, floating in the repository without anything referencing them.</p>




<p>The next step is to replay the master commits onto the new structure. This is done one-by-one, and can sometimes result in conflicts that will need to be handled like any merge.</p>




<p>After replaying the repository will look like this:</p>


<p><img src="/images/GitGuts2_Figure9.png" alt="Figure 1" /></p>

<p>The master branch commits are now on the top of the stack, after the commits from the feature branch.</p>




<p>You should recall that commits are immutable, and for changes to be made commits need to be recreated. A rebase is a destructive operation, as it has to rewrite commits to be able to work. In this case, the commits from feature have been unaffected, but the master commits have been assigned new parents (and thus rewritten). What&#8217;s also noticeable is there&#8217;s a lack of a merge commit, which isn&#8217;t needed because the commits have been integrated into the tree; any conflicts are stored in the amended commits, rather than in a merge commit.</p>




<p>The rewriting of commits in a rebase is what makes it a dangerous operation to perform on any branch that has already been pushed to the public (or specifically, that the changes affected by the rebase have already been pushed to the public). A rebase can cause problems upstream, like mentioned in the previous section.</p>




<p>Rebase has it&#8217;s place though. If you&#8217;re working locally and haven&#8217;t yet pushed your changes public, it can be a useful tool. Rebase can be used to pull in changes from upstream in the order that the upstream repository has them, and your local changes (that can be rewritten because you&#8217;re the only one with them) can be replayed on-top; this is a really easy way to keep your repository up-to-date with an authoritative source. You can also use Rebase to manage local branches that you don&#8217;t necessarily want polluting the history with merge markers.</p>




<h3>When to rebase and when to merge?</h3>




<p>Merge when you&#8217;ve already made changes public, and when you want to indicate that two tree&#8217;s have converged. Rebase pretty much any other time.</p>




<p>That&#8217;s it for this time. Same deal as last time, if you have anything you&#8217;d like me to cover I&#8217;ll nail it in the next one.</p>


        
        
    </div>
    <div class="meta">
        <div class="date">








  


<time datetime="2009-11-27T00:00:00+11:00" pubdate data-updated="true">Nov 27<span>th</span>, 2009</time></div>
        <div class="tags">

</div>
        
    </div>
</article>


    <article class="post">
    <h1 class="title"><a href="/writings/gits-guts-branches-head-and-fast-forwards/">Git&#8217;s Guts: Branches, HEAD, and Fast-forwards</a></h1>
    <div class="entry">
        <blockquote>Cross posted to <a href="http://www.lostechies.com/blogs/jagregory/archive/2009/11/25/git-s-guts-branches-head-and-fast-forwards.aspx">Los Techies</a></blockquote>




<p>Lets get some learning done. There are a few questions that keep cropping up when I introduce people to Git, so I thought I&#8217;d post some answers as a mini-series of blog posts. I&#8217;ll cover some fundamentals, while trying not to retread too much ground that the fantastic <a href="http://book.git-scm.com">Git community book</a> already covers so well. Instead I&#8217;m going to talk about things that should help you understand what you and Git are doing day-to-day.</p>




<h3>What&#8217;s a branch?</h3>




<p>I know what you&#8217;re thinking. <em>&#8220;C&#8217;mon, we know what a branch is&#8221;</em>. A branch is a copy of a source tree, that&#8217;s maintained separately from it&#8217;s parent; that&#8217;s what we perceive a branch to be, and that&#8217;s how we&#8217;re used to dealing with them. Sometimes they&#8217;re physical copies (VSS and TFS), other times they&#8217;re lightweight copies (SVN), but they&#8217;re copies non-the-less. Or are they?</p>




<p>Lets look at it a different way. <em>The Git way</em>.</p>




<p>Git works a little differently than most other version control systems. It doesn&#8217;t store changes using <a href="http://en.wikipedia.org/wiki/Delta_encoding">delta encoding</a>, where complete files are built up by stacking differences contained in each commit. Instead, in Git each commit stores a snapshot of how the repository looked when the commit occurred; a commit also contains a bit of meta-data, author, date, but more importantly a reference to the parent of the commit (the previous commit, usually).</p>




<p>That&#8217;s a bit weird, I know, but bare with me.</p>




<p>So what is a branch? Nothing more than a pointer to a commit (with a name). There&#8217;s nothing physical about it, nothing is created, moved, copied, nothing. A branch contains no history, and has no idea of what it consists of beyond the reference to a single commit.</p>




<p>Given a stack of commits:</p>


<p><img src="/images/GitGuts1_Figure1.png" alt="Figure 1" /></p>

<p>The branch references the newest commit. If you were to make another commit in this branch, the branch&#8217;s reference would be updated to point at the new commit.</p>


<p><img src="/images/GitGuts2_Figure2.png" alt="Figure 2" /></p>

<p>The history is built up by recursing over the commits through each&#8217;s parent.</p>




<h3>What&#8217;s HEAD?</h3>




<p>Now that you know what a branch is, this one is easy. <code>HEAD</code> is a reference to the latest commit in the branch you&#8217;re in.</p>




<p>Given these two branches:</p>


<p><img src="/images/GitGuts1_Figure3.png" alt="Figure 3" /></p>

<p>If you had master checked out, <code>HEAD</code> would reference <code>e34fa33</code>, the exact same commit that the master branch itself references. If you had feature checked out, <code>HEAD</code> would reference <code>dde3e1</code>. With that in mind, as both <code>HEAD</code> and a branch is just a reference to a commit, it is sometimes said that <code>HEAD</code> points to the current branch you&#8217;re on; while this is not strictly true, in most circumstances it&#8217;s close enough.</p>




<h3>What&#8217;s a fast-forward?</h3>




<p>A fast-forward is what Git does when you merge or rebase against a branch that is simply ahead the one you have checked-out.</p>




<p>Given the following branch setup:</p>


<p><img src="/images/GitGuts1_Figure4.png" alt="Figure 4" /></p>

<p>You&#8217;ve got both branches referencing the same commit. They&#8217;ve both got exactly the same history. Now commit something to feature.</p>


<p><img src="/images/GitGuts1_Figure5.png" alt="Figure 5" /></p>

<p>The <code>master</code> branch is still referencing <code>7ddac6c</code>, while <code>feature</code> has advanced by two commits. The <code>feature</code> branch can now be considered ahead of <code>master</code>.</p>




<p>It&#8217;s now quite easy to see what&#8217;ll happen when Git does a fast-forward. It simply updates the <code>master</code> branch to reference the same commit that <code>feature</code> does. No changes are made to the repository itself, as the commits from <code>feature</code> already contain all the necessary changes.</p>




<p>Your repository history would now look like this:</p>


<p><img src="/images/GitGuts1_Figure6.png" alt="Figure 6" /></p>

<h3>When doesn&#8217;t a fast-forward happen?</h3>




<p>Fast-forwards don&#8217;t happen in situations where changes have been made in the original branch and the new branch.</p>


<p><img src="/images/GitGuts1_Figure7.png" alt="Figure 7" /></p>

<p>If you were to merge or rebase <code>feature</code> onto <code>master</code>, Git would be unable to do a fast-forward because the trees have both diverged. Considering Git commits are immutable, there&#8217;s no way for Git to get the commits from <code>feature</code> into <code>master</code> without changing their parent references.</p>




<p>For more info on all this object malarky, I&#8217;d recommend reading the <a href="http://book.git-scm.com">Git community book</a>.</p>


        
        
    </div>
    <div class="meta">
        <div class="date">








  


<time datetime="2009-11-25T00:00:00+11:00" pubdate data-updated="true">Nov 25<span>th</span>, 2009</time></div>
        <div class="tags">

</div>
        
    </div>
</article>


    <article class="post">
    <h1 class="title"><a href="/writings/fluent-nhibernate-10-rtm/">Fluent NHibernate 1.0 RTM</a></h1>
    <div class="entry">
        <p>It&#8217;s <a href="http://fluentnhibernate.org/downloads">here</a>.</p>

<p>For those of you that don&#8217;t know, <a href="http://fluentnhibernate.org">Fluent NHibernate</a> is for helping you map entities with <a href="http://nhforge.org">NHibernate</a>. It&#8217;s based firmly on the practice of <a href="http://en.wikipedia.org/wiki/Convention_over_configuration">convention-over-configuration</a>, and can be used in a mapping-per-class style using our <a href="http://wiki.fluentnhibernate.org/Fluent_mapping">fluent interface</a>, or let our <a href="http://wiki.fluentnhibernate.org/Auto_mapping">automapper</a> map your entities itself.</p>

<p>This release introduces a few significant changes, and a lot of insignificant ones. You should refer to the <a href="http://wiki.fluentnhibernate.org/Release_notes_1.0">1.0 release notes</a> for an overview of what&#8217;s changed.</p>

<p>The <a href="http://wiki.fluentnhibernate.org">wiki</a> has also been upgraded to use different software which should hopefully stop people being blocked, and make it a bit more stable; the upgrade included completely rewriting all of the pages, so don&#8217;t anyone say that it&#8217;s out of date.</p>

<p>You can get the binaries from the our <a href="http://fluentnhibernate.org/downloads">downloads page</a>, or get the source from the <a href="http://github.com/jagregory/fluent-nhibernate">github site</a>.</p>

<p>Special thanks go out to the Fluent NHibernate team, Paul Batum, Hudson Akridge, Andrew Stewart, and Stuart Childs. Each of them has put in time and effort above what was asked of them, and they&#8217;ve all felt guilty when not contributing, which is great. Thanks also to all the testers and contributors we&#8217;ve had over the months. Specifically Darko Conrad, for finding about 30 separate issues with the release candidiate; Everett Muniz and his subclasses, who now has a test of his own; and Kevin Dente, for deciding to moan about our method names only <em>after</em> months of work and a release candidate. I owe everyone beers if ever I&#8217;m in your area.</p>

<p>Fabio Maulo, Ayende, and the rest of the NHibernate team: Thanks for a great tool. NHibernate is a shining example of all that is good in open source in the .Net world.</p>

<p>&#8230;and with that, I&#8217;m going on <a href="http://maps.google.co.uk/maps?f=d&source=s_d&saddr=Sydney&daddr=Brisbane+to:Cairns&hl=en&geocode=&mra=ls&sll=-25.656382,152.880249&sspn=1.383954,1.851196&ie=UTF8&ll=-25.522615,152.358398&spn=22.065278,29.619141&z=5">holiday</a>.</p>

        
        
    </div>
    <div class="meta">
        <div class="date">








  


<time datetime="2009-08-29T00:00:00+10:00" pubdate data-updated="true">Aug 29<span>th</span>, 2009</time></div>
        <div class="tags">

</div>
        
    </div>
</article>


    <article class="post">
    <h1 class="title"><a href="/writings/preventing-debugger-property-evaluation-side-effects/">Preventing Debugger Property Evaluation for Side-effect Laden Properties</a></h1>
    <div class="entry">
        <p>Property getters with side-effects, now there&#8217;s a controversial subject if ever I saw one. Don&#8217;t do it is the rule; as with any rule though, there&#8217;s generally an exception that proves it. If you&#8217;re in this situation and you genuinely do have a scenario that requires a property getter to have side-effects, then there&#8217;s a side-effect (ha!) that you should be aware of.</p>




<p><strong>The debugger evaluates property getters when showing it&#8217;s locals and autos windows.</strong> While this feature is indispensable in most cases, it plays havoc with our property-with-side-effects. What the debugger does is call the getter to present it&#8217;s value in the autos window, at the same time firing our code that has a side-effect. From there you have pretty confusing behavior with code seemingly running itself.</p>




<p>My exception to the rule is mutator properties in a fluent interface. You can often find properties in fluent interfaces that when touched alter the behavior of the next method called.</p>




<p>For example:</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="kt">string</span> <span class="k">value</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="n">Is</span><span class="p">.</span><span class="n">Null</span><span class="p">(</span><span class="k">value</span><span class="p">)</span>      <span class="c1">// returns true</span>
</span><span class='line'><span class="n">Is</span><span class="p">.</span><span class="n">Not</span><span class="p">.</span><span class="n">Null</span><span class="p">(</span><span class="k">value</span><span class="p">)</span>  <span class="c1">// returns false</span>
</span></code></pre></td></tr></table></div></figure>




<p>The Is class would contain a value tracking whether the next call would be inverted or not, and the Not property would flip that value when called.</p>




<p>Now assume this, you&#8217;re using <code>Is.Null(value)</code> and you set a breakpoint on it. Your autos window has expanded Is and shows the Not property, what&#8217;s just happened? The debugger has now called Not and altered your state! Undesirable.</p>




<p><a href="http://msdn.microsoft.com/en-us/library/system.diagnostics.debuggerbrowsableattribute.aspx">DebuggerBrowsable attribute</a> to the rescue; this attribute when used with the DebuggerBrowsableState.Never parameter instructs Visual Studio to never inspect the property you apply it to. Your property won&#8217;t appear in the autos or locals window, and if you expand the tree of an instance containing the property it will show up with a Browsing Disabled message; you can then force it to evaluate the property, but at least it doesn&#8217;t do it automatically.</p>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">private</span> <span class="kt">bool</span> <span class="n">inverted</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="na">[DebuggerBrowsable(DebuggerBrowsableState.Never)]</span>
</span><span class='line'><span class="k">public</span> <span class="n">Is</span> <span class="n">Not</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="k">get</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>    <span class="n">inverted</span> <span class="p">=</span> <span class="p">!</span><span class="n">inverted</span><span class="p">;</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>




<p>Sticking the DebuggerBrowsable attribute on your Not property prevents the debugger from hitting it and inverting the switch.</p>




<p>So there you go, if your property-with-side-effects is being invoked by the debugger, you can use the DebuggerBrowsableAttribute to prevent it.</p>




<blockquote>By the way, I&#8217;m not advocating properties with side-effects&#8230;</blockquote>


        
        
    </div>
    <div class="meta">
        <div class="date">








  


<time datetime="2009-08-18T00:00:00+10:00" pubdate data-updated="true">Aug 18<span>th</span>, 2009</time></div>
        <div class="tags">

</div>
        
    </div>
</article>


    <article class="post">
    <h1 class="title"><a href="/writings/fluent-nhibernate-10rc/">Fluent NHibernate 1.0RC</a></h1>
    <div class="entry">
        <p>It&#8217;s nearly here, at long last <a href="http://fluentnhibernate.org">Fluent NHibernate</a> has nearly reached 1.0. Now starts the official public testing of our 1.0RC.</p>

<p>You can read the <a href="http://wiki.fluentnhibernate.org/Release_notes_1.0">release notes</a> on the wiki for more information on what&#8217;s changed. There have been a lot of small breaking changes in the fluent interface, mostly reducing it&#8217;s verbosity, and a few larger changes elsewhere. Don&#8217;t expect to download this and have it <em>just work</em>, because it won&#8217;t; hopefully it shouldn&#8217;t be too painful though.</p>

<p>My plan is that this is a very quick turnaround for a release candidate. It&#8217;s already undergone some heavy testing from some respected volunteers, but I wanted to get it into the public eye for a week or so before release. Ideally the RTM release won&#8217;t differ from this one at all, but we&#8217;ll see.</p>

<p>You can find the binaries on our <a href="http://fluentnhibernate.org/downloads">downloads page</a>, and it&#8217;s now included in the binary build releases too.</p>

<p>Any questions should be directed to the <a href="http://groups.google.com/group/fluent-nhibernate">mailing-list</a>, and issues onto our <a href="http://code.google.com/p/fluent-nhibernate/issues/list">issue list</a>.</p>

        
        
    </div>
    <div class="meta">
        <div class="date">








  


<time datetime="2009-08-16T00:00:00+10:00" pubdate data-updated="true">Aug 16<span>th</span>, 2009</time></div>
        <div class="tags">

</div>
        
    </div>
</article>


    <article class="post">
    <h1 class="title"><a href="/writings/git-and-command-line-fear/">Git and Command-line Fear</a></h1>
    <div class="entry">
        <blockquote><p>Cross-posted to <a href="http://www.lostechies.com/blogs/jagregory/archive/2009/07/20/git-s-and-command-line-fear.aspx">Los Techies</a></p></blockquote>

<p><a href="http://git-scm.org">Git</a> has been gaining a lot of traction lately, and rightly so. I&#8217;ve used it for a couple of years now, for all my projects (<a href="http://fluentnhibernate.org">Fluent NHibernate</a> and <a href="http://docu.jagregory.com">Docu</a> being the prominent ones), but something that hasn&#8217;t changed is the tag-line of &#8220;but Windows support isn&#8217;t very good!&#8221;. What you quickly learn is that when people say that, they actually mean there isn&#8217;t a Visual Studio plug-in or some similar all-singing all-dancing GUI; this is a dire misrepresentation of Git, because it&#8217;s tooling on Windows is excellent if your definition of tooling includes the command-line.</p>

<p>It&#8217;s something ingrained in Windows developers, they hate the command-line. There&#8217;s a very good chance that if you encounter a Windows developer that does enjoy using the command-line it&#8217;s because they&#8217;ve also worked on another platform or in another environment that encourages command-line use (Rails is a good example). I&#8217;ve tried various ways of encouraging people to experiment, but very few work without being able to sit down and just show them something. It&#8217;s very much like R# adoption, nobody thinks it&#8217;ll speed them up until they see how fast someone else can be.</p>

<p>Back onto Git. If you don&#8217;t like what Git does, then that&#8217;s fine, but don&#8217;t label yourself as Alt.Net or a continuous improver if this sounds like you: &#8220;I define myself by choosing the best tool for each situation, but there&#8217;s no way you&#8217;ll get me using the command-line.&#8221; Way to go, oh open-minded one. Try it, you might like it.</p>

<p>The other techies have been posting some great <a href="http://www.lostechies.com/blogs/tags/git/default.aspx">Git posts</a> which can help you get up to speed. I hope to contribute, with less bile, soon.</p>

        
        
    </div>
    <div class="meta">
        <div class="date">








  


<time datetime="2009-07-20T00:00:00+10:00" pubdate data-updated="true">Jul 20<span>th</span>, 2009</time></div>
        <div class="tags">

</div>
        
    </div>
</article>


    <article class="post">
    <h1 class="title"><a href="/writings/whats-been-happening-in-fluent-nhibernate-land/">What&#8217;s Been Happening in Fluent NHibernate Land?</a></h1>
    <div class="entry">
        <blockquote>Cross-posted to <a href="http://jagregory.lostechies.com/archive/2009/04/28/what-s-been-happening-in-fluent-nhibernate-land.aspx">Los Techies</a></blockquote>


<p><a href="http://www.fluentnhibernate.org">Fluent NHibernate</a> has seen a flurry of development followed by a complete lack of commits, I figure it&#8217;s time to let everyone know what&#8217;s going on.</p>

<p><strong>The Short Version</strong></p>

<p>We&#8217;re rewriting the internals. We have 100% of tests passing, but still can&#8217;t guarantee no regressions. Stuff may break, if it does, <a href="http://groups.google.com/group/fluent-nhibernate">tell us</a>. It&#8217;ll be worth it.</p>

<p><strong>The Long Version</strong></p>

<p>Once upon a time&#8230;</p>

<p>Fluent NHibernate at it&#8217;s core is a fluent interface over xml generation. We use the series of methods you call in your mappings to build up an in-memory hbm xml document that we then feed to NHibernate. Slowly, as we&#8217;ve started to support more and more of NHibernate&#8217;s features, we&#8217;ve started to find flaws in our architecture. It amounts to us not having enough separation of concerns; our fluent interface is generating xml, I think most people would say that&#8217;s not a good thing. Our xml is being generated too soon in the cycle to allow us to do more clever things that&#8217;d improve the user&#8217;s experience. That&#8217;s where the quiet time comes in.</p>

<p><a href="http://www.paulbatum.com">Paul Batum</a> undertook the task of redesigning the internals of Fluent NHibernate to be something much more scalable. I&#8217;ll leave the details out for now (maybe a future post), but it amounts to a intermediary layer being introduced between the fluent interface and the xml generation. We&#8217;ve dubbed this the Semantic Model, and it&#8217;s that which is now generated by the fluent interface, then later translated into xml. This added abstraction allows us to do things that weren&#8217;t possible while we were just generating straight xml.</p>

<p>Whilst you wont see any immediate improvements while everything is being converted, the extra layer allows us to inspect the model before it is converted to xml; this gives us some immense capabilities, such as allowing subclasses to be separate from their parent mapping, create reusable component mappings, improve relationship support etc&#8230; We&#8217;re pretty much limited only by what we can imagine now, rather than by architectural decisions.</p>

<p>However, we have a dilemma. The semantic-model branch has deviated so much from trunk we&#8217;ve got a major merge problem. A merge is pretty much out of the question actually, because there&#8217;s barely any commonality between the two streams at all. It was then assumed that the branch would eventually replace trunk (we&#8217;d just rename trunk to a tag, then rename the semantic-model branch to trunk), and all we needed to do was get the branch up-to-date with the features of trunk. Little did we realise we were essentially committing to something that I typically oppose, a complete rewrite! I&#8217;ve never been in a situation where that&#8217;s ever been a good idea, and yet here we are, responsible for our own destiny as it was, and we&#8217;d chosen a rewrite!</p>

<p>A few weeks went by with very little work happening. I think we&#8217;d all started feeling demoralised by the idea of re-implementing most of the features from trunk using the new design. It was a worthwhile endeavor, definitely, but just very uninteresting. We repeatedly swore that we&#8217;d get this done, but all the while we felt less inclined to support trunk because every new feature meant a new feature to port too. We stopped.</p>

<p>At that point <a href="http://www.bestguesstheory.com/">Hudson Akridge</a>, our newest contributor, had the balls to tell me that he thought what we were doing felt pretty futile. At that moment I gained a great deal of respect for him, as it&#8217;s something that was in the back of my mind for some time but I wasn&#8217;t ready to face yet. It was that which got me moving again.</p>

<p>I sat down over a long weekend and took on the mammoth task of merging our rewrite branch and trunk, with the aim of allowing the existing code to exist alongside the new code; this approach, if it worked, would allow us to convert existing features at our own pace while still writing new features for the cleaner codebase. After a lot of unpleasant hacking of nice code, I managed to get all our existing tests passing while utilising the semantic model behind the scenes. Our old code still directly generates xml, which then gets injected into the semantic model via a nasty shortcut. It feels dirty, because I&#8217;ve had to comprimise some good code to get it working, but in a way I think that&#8217;s a good thing; if code is nasty, we&#8217;re all less likely to be content with it. The main goal was achieved though, and that was to allow us to work at our own pace on trunk.</p>

<p>Where we stand now is three branches, trunk, integration, and semantic-model. Over the next day or so I am going to merge integration with trunk, which will mean the semantic model will be in use for new features. From there we can slowly migrate all the original code to use our new semantic model, all the while adding new features using it, then eventually remove the duct-tape that&#8217;s holding the legacy code to the new code and dump the old stuff.</p>

<p>This is where I&#8217;ll give you a little warning: although we have 100% of tests passing, we don&#8217;t have 100% coverage. There may be some regressions that we aren&#8217;t aware of. If anyone finds anything broken that was working before, contact us immediately on the <a href="groups.google.com/group/fluent-nhibernate">mailing list</a> or via the <a href="http://code.google.com/p/fluent-nhibernate/issues/list">issues list</a> and we&#8217;ll correct it. Regressions will be treated with the highest priority over any other work.</p>

<p>That&#8217;s it, you now know more about what&#8217;s happening with Fluent NHibernate than you ever wanted to. I hope this sheds a little light onto what&#8217;s been happening with us, and perhaps why your patch hasn&#8217;t been applied as quickly as you would&#8217;ve liked.</p>

        
        
    </div>
    <div class="meta">
        <div class="date">








  


<time datetime="2009-04-28T00:00:00+10:00" pubdate data-updated="true">Apr 28<span>th</span>, 2009</time></div>
        <div class="tags">

</div>
        
    </div>
</article>


    <article class="post">
    <h1 class="title"><a href="/writings/im-a-los-techie/">I&#8217;m a Los Techie</a></h1>
    <div class="entry">
        Just to let anyone know that hasn&#8217;t heard by other means, I&#8217;m now blogging at <a href="http://lostechies.com">Los Techies</a>. I&#8217;m going to cross-post between these two blogs, so there&#8217;s no need to update your feeds if you&#8217;re too lazy; but if you&#8217;re already subscribing to the Los Techies general feed then you&#8217;ll now get me too.

You can find my blog at: <a href="http://jagregory.lostechies.com">jagregory.lostechies.com</a>

        
        
    </div>
    <div class="meta">
        <div class="date">








  


<time datetime="2009-03-28T00:00:00+11:00" pubdate data-updated="true">Mar 28<span>th</span>, 2009</time></div>
        <div class="tags">

</div>
        
    </div>
</article>


    <article class="post">
    <h1 class="title"><a href="/writings/fluent-nhibernate-usage-stats/">Fluent NHibernate Usage Stats</a></h1>
    <div class="entry">
        Just been totting up some figures on how <a href="http://fluentnhibernate.org">Fluent NHibernate</a> is doing, thought I&#8217;d share them with anyone that&#8217;s interested.

<blockquote>These are very rough figures, generated with no scientific consistency, some are cumulative and others are based just on the last full month. They&#8217;re more just to satisfy my curiosity than to be rigorously accurate.</blockquote>

<table>
  <tr>
    <td>Downloads</td>
    <td>1,800 per month</td>
  </tr>
  <tr>
    <td>Unique visitors</td>
    <td>5,500 per month</td>
  </tr>
  <tr>
    <td>Page views</td>
    <td>13,000 per month</td>
  </tr>
  <tr>
    <td>Mailing list messages</td>
    <td>450 per month</td>
  <tr>
    <td>Commits</td>
    <td>45 per month</td>
  </tr>
</table>

Something else that&#8217;s interesting is of those 5,500 visitors/13,000 page views, 66% are coming directly from google, 4% directly, then the other 30% from referrers. Those referrers are broken down into (from highest to lowest): <a href="http://stackoverflow.com">Stack Overflow</a>, <a href="http://blog.jagregory.com">my blog</a>, <a href="http://pnpguidance.net">pnpguidance.net</a>, <a href="http://nhforge.org">nhforge</a>, then quite a few other sites forming the lower percentages. I&#8217;m surprised at how high Stack Overflow is, I guess it pays that I pay attention to questions asked about Fluent on there.

Those download numbers are probably not representative either as they&#8217;re only of the zip files, while I believe the vast majority of people run off the trunk through Subversion, so it&#8217;s hard to count them.

        
        
    </div>
    <div class="meta">
        <div class="date">








  


<time datetime="2009-03-21T00:00:00+11:00" pubdate data-updated="true">Mar 21<span>st</span>, 2009</time></div>
        <div class="tags">

</div>
        
    </div>
</article>


    <article class="post">
    <h1 class="title"><a href="/writings/docu-2-days/">Docu + 2 Days</a></h1>
    <div class="entry">
        <p>It&#8217;s been two days since I <a href="/writings/introducing-docu-simple-doc-gen-for-net/">announced</a> <a href="http://docu.jagregory.com">docu</a>, my simple documentation generator for .Net apps.</p>

<p>The reception it&#8217;s received has been positive, I never expected it to have a surge of popularity because it&#8217;s not that kind of tool, so it hasn&#8217;t come as much of a surprise that people haven&#8217;t been jumping all over it. Having said that though, I have had some good feedback and already someone has contributed a patch. Additionally, there hasn&#8217;t been one question as to why I&#8217;ve created it; now this has come as a surprise, I guess I&#8217;m <strong>not</strong> the only one that feels Sandcastle is bloated and overcomplicated. Yay!</p>

<p>I&#8217;ve just pushed out some changes to the <a href="http://github.com/jagregory/docu">github repos</a> and released an updated alpha (v0.1.0.2) on the <a href="http://docu.jagregory.com/downloads">downloads page</a>. The biggest changes so far are the inclusion of events and fields in the parsing, which now means docu has <code>&lt;summary /&gt;</code> support for all documentable members. The rest of the changes are mainly refactorings and some battle-hardening.</p>

<p>I&#8217;ve got some more changes and several issues lined up, so keep an eye out.</p>

        
        
    </div>
    <div class="meta">
        <div class="date">








  


<time datetime="2009-03-21T00:00:00+11:00" pubdate data-updated="true">Mar 21<span>st</span>, 2009</time></div>
        <div class="tags">

</div>
        
    </div>
</article>

<nav id="pagenavi">
    
        <a href="/" class="prev">Prev</a>
    
    
        <a href="/blog/page/3/" class="next">Next</a>
    
    <a href="/blog/archives" class="center">Blog Archives</a>
</nav></div>
	<footer class="inner">Copyright &copy; 2013 James Gregory</footer>
	<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script src="/javascripts/slash.js"></script>


<script type="text/javascript">
      var disqus_shortname = 'jagregory';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



</body>
</html>