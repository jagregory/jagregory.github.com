
<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <title>James Gregory</title>
    <meta name="author" content="James Gregory">

    
    <meta name="description" content="ELMAH: Error Logging Modules & Handlers In my previous post I talked about my exception logging system that I laid to rest. Fortunately for me that &hellip;">
    
    <meta name="viewport" content="width=device-width; initial-scale=1; maximum-scale=1">

    <link href="/atom.xml" rel="alternate" title="James Gregory" type="application/atom+xml">
    <link rel="canonical" href="">
    <link href="/favicon.png" rel="shortcut icon">
    <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
    
    <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    
    
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-3186192-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body>
	<header class="inner"><h1 class="left"><a href="/">James Gregory</a></h1>
<nav class="menu left"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
</ul>
</nav>
<div class="right">
	<form class="search right" action="http://google.com/search" method="get">
		<input class="left" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:www.jagregory.com">
	</form>
	<div class="social right">
		
		
		
		
		<a class="github" href="https://github.com/jagregory" title="GitHub">GitHub</a>
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
	</div>
</div>

</header>
	
	<div id="content" class="inner">


    <article class="post">
    <h1 class="title"><a href="/writings/error-logging-modules-ampamp-handlers-elmah/">ELMAH: Error Logging Modules & Handlers</a></h1>
    <div class="entry">
        <p>In my previous post I talked about my exception logging system that I laid to rest. Fortunately for me that doesn’t mean my applications are logless, quite the contrary. I’ll explain…</p>

<p>When I came to terms with my logging system being inadequate and hard to maintain, I began looking for a replacement. To my delight I came across <a href="http://www.raboof.com/Projects/Elmah/Elmah.aspx"><acronym title="Error Logging Modules &amp; Handlers">ELMAH</acronym></a>  written by <a href="http://www.raboof.com">Atif Aziz</a>. <acronym title="Error Logging Modules &amp; Handlers">ELMAH</acronym> is basically a couple of HttpModules and a HttpHandler that intercept any unhandled exceptions from within your application and log them. This is where the fun begins…</p>

<p>You can download/create extensions that enable you to save your logs to wherever takes your fancy. There is a SQL Server writer, an XML file writer and I believe an MySql writer too. I’m currently using the XML writer simply because connecting to the SqlServer may be one of the possible exceptions raised. I’ve been running ELMAH now for 2 weeks and have had no issues at all; especially no write-permission related ones!</p>

<p>This <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnaspp/html/elmah.asp" title="Using HTTP Modules and Handlers to Create Pluggable ASP.NET Components">MSDN Article</a> by <a href="http://www.4guysfromrolla.com/ScottMitchell.shtml">Scott Mitchell</a> was my manual for setting up ELMAH, not that it was hard. That article can explain it much better than I every could.</p>

<p>Once you’ve got it all set up and assigned a location to the HttpHandler, you can navigate there and be presented with a log viewer. Details of the exception and even the actual yellow screen that occurred too (through a dump of the html) can be accessed though that screen. The thing that got me really interested was the ability to subscribe to an RSS feed of your log! Now I no longer have to spend 40 minutes on the phone trying to decipher what really happened when the client claims they “didn’t touch a thing, it just crashed on its own”. All you have to do is (in your favourite feed reader) enter your log viewer path with “/rss” added to the end (e.g. http://www.mysite.com/Logs/View.aspx/rss). Then you can get all the same details as navigating to the page, without actually having to do anything! Oh yes, life is good.</p>

<p>There was one thing I had to come to terms with while setting up ELMAH. That is the fact that only unhandled exceptions will be logged, so that meant most of my try-catch blocks were causing my exceptions not to be logged. The solution to this was to remove the blocks that weren’t performing any specific function except that of gobbling up the exception and firing out a generic error message. I felt uncomfortable with this at first, as I was letting exceptions run riot but then I realised there’s not much point in handling exceptions if I can’t actually do anything to correct the error that occurred. So letting them go unhandled is probably the best cause of action (what exactly can be done if your SqlConnection won’t connect? It’s not like you can just connect to your mirrored SQL Server). So those exceptions are bubbled up to the page and then ELMAH captures and logs them. Using the customErrors section of the web.config you can present your users with a generic error page to stop them from seeing the nasty yellow screen.</p>

<p>That my friends is the general gist of ELMAH&#8230;</p>

        
        
    </div>
    <div class="meta">
        <div class="date">








  


<time datetime="2005-07-23T00:00:00+10:00" pubdate data-updated="true">Jul 23<span>rd</span>, 2005</time></div>
        <div class="tags">

</div>
        
    </div>
</article>


    <article class="post">
    <h1 class="title"><a href="/writings/exception-logging/">Exception Logging</a></h1>
    <div class="entry">
        <p>Something I’ve always been tinkering with for my ASP.Net applications has been exception logging. I often get irritated when users (or applications) supply me with misleading or incorrect error messages, or at least incorrect directions of how to recreate the error.</p>

<p>I worked for quite some time trying to create a Logging system that would cater for my needs, and I got quite close to doing that. I created a small go-between object for the Trace and Debug logging and wrote that to my own XML file. The idea behind it, of course, was to make it easier for my self in debugging problems, if I could supply my self with all the data that I know I would require to trace an issue then, in theory, I could correct it much more quickly. This took me quite some time to create and of course was not perfect.</p>

<p>There were a few major (a.k.a. Huge) issues with my system, firstly the logger would only interact with your code wherever you explicitly told it to. Basically you had to write extra code wherever you wanted to log an exception. This was neither friendly nor desirable. The next issue was access rights for the XML files; this reared its head in a few shapes and forms. One of the instances didn’t occur very often but was a pain when it did; the writer was rejected write access due to another instance of itself actually writing to the file. I remedied this by making the writer wait until the other was done; this of course had performance implications though, having to stop everything within a page while the log writer sits idle. The other time it was an issue was whenever I wanted to archive the logs I had to wait until no other instances were accessing it, this also involved waiting but it takes longer to rename a file and create a new one than it does to simply amend a file.</p>

<p>The problem of having to explicitly declare any usage of the writer was the deciding factor in me binning my writer. Sad as it is to see something that I spent a fair amount of time creating deleted, it’s always slightly reassuring when you’re moving onto a product that is fully tested and working and also includes all source code! More on that soon though&#8230;</p>

        
        
    </div>
    <div class="meta">
        <div class="date">








  


<time datetime="2005-07-18T00:00:00+10:00" pubdate data-updated="true">Jul 18<span>th</span>, 2005</time></div>
        <div class="tags">

</div>
        
    </div>
</article>


    <article class="post">
    <h1 class="title"><a href="/writings/a-bit-of-culture/">A Bit of Culture</a></h1>
    <div class="entry">
        <p>I think this is possibly something that everyone goes through at some point in their life, the desire to be more cultured. To me and most people this means going out and buying a lot of “classic” books and giving them a good going over. If you had tried to get me to do this a few years ago there would have been no chance of it happening, but it just so happens that I’m starting to get really into reading so this is a natural extension of things.</p>

<p>I’ve got my self the following books, anybody with any suggestions feel free to drop me a comment or e-mail.</p>

<ul>
<li>Brave New World (Aldous Huxley)</li>
<li>Heart Of Darkness (Joseph Conrad)</li>
<li>Animal Farm (George Orwell)</li>
<li>Catch-22 (Joseph Heller)</li>
<li>Gulliver&#8217;s Travels (Jonathan Swift)</li>
<li>Fahrenheit 451 (Ray Bradbury)</li>
</ul>


<p>For something a little different I also got The Interpretation of Dreams by Sigmund Freud, a slight change of pace.</p>

<p>I’ve nearly finished reading Heart of Darkness, not taken long really. Not surprising considering it’s only 100 pages long, I can’t say it’s had a huge impact on me. I may be missing the point completely but nothing really seems to have happened and I’m onto the 3rd chapter (of 3). None the less the point is that I’ve now read a piece of history and have an informed opinion of it rather than just hints of what it’s about from what I’ve picked up listening to other people.</p>

        
        
    </div>
    <div class="meta">
        <div class="date">








  


<time datetime="2005-06-13T00:00:00+10:00" pubdate data-updated="true">Jun 13<span>th</span>, 2005</time></div>
        <div class="tags">

</div>
        
    </div>
</article>


    <article class="post">
    <h1 class="title"><a href="/writings/back-once-again/">Personal Note: The New Job</a></h1>
    <div class="entry">
        <p>Since getting my new job I’ve been rather quiet on the blogging side of things, mostly do to the fact that I’m actually doing something with my time rather than just sitting around tinkering. Strange I know, but you get used to it.</p>

<p>As you’d probably expect, I’m not really supposed to talk about what I do for security reasons of course. It’s mostly working for the Swift group (caravans, motorhomes) doing their internal systems and web sites. Other things as well, but it’s mainly that. It’s all very interesting, a big change from serving customers in a supermarket thats for sure. It’s a really strange feeling actually going to work and learning something, I generally come home every night having picked something new up.</p>

<p>Since I started the job I’ve learnt that my coding abilities are much better than I thought they were, having being subjected to the woes that are legacy code. Definitely a nice feeling, it’s always rather hard to rate your abilities when you have nothing to compare them against. For better or for worse I’ve been developing in VB.Net, something I tried to stay away from when coding for my self but haven’t been able to avoid recently. Not my cup of tea really but it’s another addition to the CV. Speaking of legacy code, there’s been some serious Daily WTF material lying around. A prime example was this beauty:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='vbnet'><span class='line'><span class="k">Sub</span> <span class="nf">Function</span> <span class="n">GetTime</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">hours</span><span class="p">,</span> <span class="k">ByVal</span> <span class="n">minutes</span><span class="p">)</span>
</span><span class='line'>  <span class="k">Dim</span> <span class="n">hours</span>
</span><span class='line'>  <span class="k">Dim</span> <span class="n">minutes</span>
</span><span class='line'>  <span class="k">Dim</span> <span class="n">yHours</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">yHours</span> <span class="o">=</span> <span class="n">hours</span> <span class="o">*</span> <span class="n">minutes</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">GetTime</span> <span class="o">=</span> <span class="p">(</span><span class="n">yHours</span> <span class="o">/</span> <span class="n">minutes</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">hours</span> <span class="o">*</span> <span class="n">minutes</span><span class="p">)</span>
</span><span class='line'><span class="k">End</span> <span class="k">Sub</span>
</span></code></pre></td></tr></table></div></figure>


<p>Really interesting! Note the lack of any variable type declarations as well! It hasn’t all been like this, but there certainly a lot of amusing things.</p>

<p>One resource I’ve found invaluable since starting to code professionally is <a href="http://www.hanselman.com/">Scott Hanselman</a>’s <a href="http://www.hanselman.com/blog/content/radiostories/2003/09/09/scottHanselmansUltimateDeveloperAndPowerUsersToolsList.html">utilities list</a>, there are so many handy little tools there that I can’t believe I’ve managed to live without! Some perfect examples are <a href="http://www.aisto.com/roeder/dotnet/">Lutz’s Reflector</a> and <a href="http://www.sliver.com/dotnet/ruler/">Jeff Key’s Screen Ruler</a>. A tool for “reverse engineering” compiled .Net assemblies and a floatable screen ruler respectively.</p>

        
        
    </div>
    <div class="meta">
        <div class="date">








  


<time datetime="2005-06-06T00:00:00+10:00" pubdate data-updated="true">Jun 6<span>th</span>, 2005</time></div>
        <div class="tags">

</div>
        
    </div>
</article>


    <article class="post">
    <h1 class="title"><a href="/writings/debugging-glory/">Debugging Glory</a></h1>
    <div class="entry">
        <p>Debugging is a great thing… Often though I’ve dreamt of some greater, more useful debugger. It would have helped if I’d actually gone out and looked for such a thing.</p>

<p>Anyway, I haven’t found a better debugger. I’ve found how to use the current one better! I’ve enabled client-side script debugging, which is fantastic. No more using IE or Firefoxes vague error messages, I can now step through code just as you would VB/C#.Net. The big one for me though has to be the ability to debug Stored Procedures, yes SQL Server Stored Procedures. Breakpoints, step-through, the lot.</p>

<p>Client-side debugging is so obvious I was kicking my self when I got it working. All you need to do is go into Tools &gt; Internet Options &gt; Advanced and check the “Enable Client-Side Debugging” in Internet explorer. You may need to do some jiggery-pokery in VS but I can’t remember what.</p>

<p>SqlServer is a bit more complicated, you need to copy the mssdi98.dll from your [visual studio installation]\sqlserver folder into your sqlserver instances binn folder. Then open up Enterprise Manager and grant Exec permissions to the user you use to log-in (or the Builtin\Administrators group) for the extended procedure sp_sdidebug. Lastly in your project options in VS mark the Enable Sql Debugging. That should be it, from the server explorer in VS you should now be able to choose “step-into” from any stored procedure, function or trigger!</p>

<p>Productivity++</p>

        
        
    </div>
    <div class="meta">
        <div class="date">








  


<time datetime="2005-05-03T00:00:00+10:00" pubdate data-updated="true">May 3<span>rd</span>, 2005</time></div>
        <div class="tags">

</div>
        
    </div>
</article>


    <article class="post">
    <h1 class="title"><a href="/writings/goodbye-tesco/">Goodbye Tesco</a></h1>
    <div class="entry">
        <p>I’m outta there, finally free from the bounds of a supermarket job. I’ve been taken in by Evolution Interactive, a web/multimedia design company.</p>

<p>I’m now a ‘New Media Developer’, nicer than ‘Checkout Assistant’ if I do say so my self. It’s very strange to be in a real job, doing something that I actually want to do (and like doing). This is going to take some getting used to…</p>

        
        
    </div>
    <div class="meta">
        <div class="date">








  


<time datetime="2005-04-11T00:00:00+10:00" pubdate data-updated="true">Apr 11<span>th</span>, 2005</time></div>
        <div class="tags">

</div>
        
    </div>
</article>


    <article class="post">
    <h1 class="title"><a href="/writings/amplification-baby/">Amplification, Baby</a></h1>
    <div class="entry">
        <p>Upon receiving payment for my month of work, I promptly bought a new Amplifier for my musification; rendering me skint.</p>

<p>Thats not the point though, the amp is hot! Line 6 Spider II 210, not the biggest they make but big enough for me. It weighs a bloody tonne! This thing comes laden with 12 pre-defined tones, 4 custom presets and all the knobs you know you couldn’t live without.</p>

<p>The 12 default tones range from your standard spangly Clean tone right the way up to some godforsaken guttural death metal style distortion, with everything in between. Each one of these tones can be tweaked to your hearts content via the knobs, if you make a tone that you are particularly fond of you can store it in one of the 4 custom presets. These can be accessed via the 4 buttons on the head, or via the footpedal that comes with it. If you pay an extra £100 you can get a FBV Shortboard pedal that enables you to save up to 36 (I think) presets, nice!</p>

<p>Built in tuner, noise-gate, tap-tempo for effects… Pretty good for £300.
Now I can sound like Hendrix, even if I can’t play like him. (Hey, its better than not being able to sound like him OR play like him!</p>

        
        
    </div>
    <div class="meta">
        <div class="date">








  


<time datetime="2005-03-07T00:00:00+11:00" pubdate data-updated="true">Mar 7<span>th</span>, 2005</time></div>
        <div class="tags">

</div>
        
    </div>
</article>


    <article class="post">
    <h1 class="title"><a href="/writings/caesar-and-delphi/">Caesar and Delphi</a></h1>
    <div class="entry">
        <p>While bored yesterday I decided to have a go with programming in Delphi, something which I’ve been intending to do for quite some time now. Anyway, here is the result.</p>

<p><a href="#">Download CaesarShift.zip 244kb</a> (this download is no longer available, sorry)</p>

<p>It’s a simple cryptography program based on the shifting letters (Caesar Shift) methods. Took me about two hours, not bad to say I’ve never programmed in Delphi before.</p>

<p>Delphi seems nice, I’m not too keen on the syntax of the language though. Its all rather too much like VB for my likings, messy and unstructured. Maybe thats just me though.</p>

        
        
    </div>
    <div class="meta">
        <div class="date">








  


<time datetime="2005-01-07T00:00:00+11:00" pubdate data-updated="true">Jan 7<span>th</span>, 2005</time></div>
        <div class="tags">

</div>
        
    </div>
</article>


    <article class="post">
    <h1 class="title"><a href="/writings/host-problems-again/">Host Problems&#8230; Again</a></h1>
    <div class="entry">
        <p>I’m back again (I know this post is a bit late), my ex-host returned my domain name to the registrar and I’ve had to re-jiggle things to get it pointed at the right place.</p>

<p>It all happened something like this:</p>

<ol>
    <li>Web-host returns domain name.</li>
    <li>I contact Nominet regarding re-tagging my now de-tagged domain.</li>
    <li>I fill out a form.</li>
    <li>I fax the form with proof of ID.</li>
    <li>I wait 5 days for them to do anything.</li>
    <li>Upon re-tagging, I contact a new domain management company to take care of my domain.</li>
    <li>I wait a day for them to change my nameservers.</li>
</ol>


<p>The end!</p>

        
        
    </div>
    <div class="meta">
        <div class="date">








  


<time datetime="2004-12-05T00:00:00+11:00" pubdate data-updated="true">Dec 5<span>th</span>, 2004</time></div>
        <div class="tags">

</div>
        
    </div>
</article>

<nav id="pagenavi">
    
        <a href="/blog/page/10/" class="prev">Prev</a>
    
    
    <a href="/blog/archives" class="center">Blog Archives</a>
</nav></div>
	<footer class="inner">Copyright &copy; 2013 James Gregory</footer>
	<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script src="/javascripts/slash.js"></script>


<script type="text/javascript">
      var disqus_shortname = 'jagregory';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



</body>
</html>