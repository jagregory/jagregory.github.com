<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

    <title>James Gregory</title>
    <meta name="description" content="Code monkey. ThoughtWorks. Chief Agitator.
" />

    <meta name="HandheldFriendly" content="True" />
    <meta name="MobileOptimized" content="320" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css" href="/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400" />
    <!-- Customisation  -->
    <link rel="stylesheet" type="text/css" href="/css/main.css" />

</head>
<body class="home-template">

    <header class="main-header no-cover">
    <div class="vertical">
        <div class="main-header-content inner">
            <h1 class="page-title"><a href="/">James Gregory</a></h1>
            <h2 class="page-description">
                 Code monkey. ThoughtWorks. Chief Agitator.
 
            </h2>
        </div>
    </div>
    <a class="scroll-down icon-arrow-left" href="#content" data-offset="-45"><span class="hidden">Scroll Down</span></a>
</header>

<main id="content" class="content" role="main">
    <div class="extra-pagination inner">
        <nav class="pagination" role="pagination">
    
        
            <a class="newer-posts" href="/page10/" title="Previous Page">&laquo; Newer Posts</a>
      
    
    <span class="page-number"> Page 11 of 23 </span>
     
        <a class="older-posts" href="/page12/" title="Next Page">Older Posts &raquo;</a>
     
</nav>
    </div>

    

    <article class="post">
        <header class="post-header">
            <h2 class="post-title"><a href="/writings/brace-matching-and-your-language-service">Brace Matching and your Language Service</a></h2>
        </header>
        <section class="post-excerpt">
            <p>I’ve been meaning to write up some of my experiences developing for Visual Studio while I’ve been working on <a href="http://www.codeplex.com/BooLangStudio">BooLangStudio</a>, but I can never seem to find the time; either that, or when I can I’m not confident enough in what I’m doing to put it out here as a valid resource.</p>

<p>I’ll start small, here’s a quick guide to how I’ve implemented brace matching using the managed Visual Studio extensibility SDK.</p>

<p><strong>What exactly is brace matching?</strong> Brace matching is where paired characters are highlighted when one or the other is selected in the editor.</p>

<p><img src="/images/bracematching-1.png" alt="Brace matching" /></p>

<p>There are a couple of things you need to consider when you implement brace matching.</p>

<p>Firstly, there are different types of braces that can be matched (depending on your language). Taking C# as an example, the brace matching works with parentheses (<code class="highlighter-rouge">()</code>), box brackets (<code class="highlighter-rouge">[]</code>), braces (<code class="highlighter-rouge"><span class="p">{}</span></code>), and chevrons (<code class="highlighter-rouge">&lt;&gt;</code>). These all need to be paired independently, as to avoid matching an open parenthesis with a closing brace.</p>

<p>Secondly, the matching has to work bi-directionally. The user can place their caret at either side of the bracket pair, and the highlighting should know where both sides are regardless.</p>

<h2 id="languageservice-implementation">LanguageService implementation</h2>

<p>A lot of the legwork of implementing a language in Visual Studio is done in the LanguageService, and brace matching is no exception. You should already have a <code class="highlighter-rouge">ParseSource</code> method in your LanguageService; this is where we’re going to work.</p>

<p>The <code class="highlighter-rouge">ParseSource</code> method has a <code class="highlighter-rouge">ParseRequest</code> parameter, which exposes a <code class="highlighter-rouge">Reason</code> property. When this property is set to <code class="highlighter-rouge">MatchBraces</code>, that’s when we need to do our processing.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">public</span> <span class="k">override</span> <span class="n">AuthoringScope</span> <span class="nf">ParseSource</span><span class="p">(</span><span class="n">ParseRequest</span> <span class="n">request</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">Reason</span> <span class="p">==</span> <span class="n">ParseReason</span><span class="p">.</span><span class="n">MatchBraces</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="c1">// match braces here
</span>  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>What needs to be done is pretty simple: Parse the open document and find the partner to the brace that the caret is on.</p>

<p>In BooLangStudio I’ve implemented this in the following fashion:</p>

<ul>
  <li>Run the document through a <code class="highlighter-rouge">BracketPairFinder</code>, which creates a list of bracket pairs in the document</li>
  <li>Get the index of the caret (baring in mind you have to translate between the Request’s Line and Column, and an actual string index)</li>
  <li>Find the pair that the caret is positioned at</li>
  <li>Get the opposite bracket from the pair</li>
  <li>Get the Line and Column of the opposite bracket</li>
</ul>

<p>It’s up to you how you implement the above steps, as long as you end up with the opposite bracket to the one you started with. I’ll illustrate using the BooLangStudio source.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">public</span> <span class="k">override</span> <span class="n">AuthoringScope</span> <span class="nf">ParseSource</span><span class="p">(</span><span class="n">ParseRequest</span> <span class="n">request</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">Reason</span> <span class="p">==</span> <span class="n">ParseReason</span><span class="p">.</span><span class="n">MatchBraces</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="c1">// find all pairs
</span>    <span class="n">var</span> <span class="n">bracketFinder</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">BracketPairFinder</span><span class="p">();</span>
    <span class="n">var</span> <span class="n">bracketPairs</span> <span class="p">=</span> <span class="n">bracketFinder</span><span class="p">.</span><span class="nf">FindPairs</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">Text</span><span class="p">);</span>

    <span class="c1">// get index of caret from source text
</span>    <span class="n">Source</span> <span class="n">source</span> <span class="p">=</span> <span class="n">languageService</span><span class="p">.</span><span class="nf">GetSource</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">View</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">indexOfCaret</span> <span class="p">=</span> <span class="n">source</span><span class="p">.</span><span class="nf">GetPositionOfLineIndex</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">Line</span><span class="p">,</span> <span class="n">request</span><span class="p">.</span><span class="n">Col</span><span class="p">);</span>

    <span class="c1">// find the partner to the bracket at the caret
</span>    <span class="kt">int</span><span class="p">?</span> <span class="n">partner</span> <span class="p">=</span> <span class="n">bracketPairs</span><span class="p">.</span><span class="nf">FindPartnerIndex</span><span class="p">(</span><span class="n">indexOfCaret</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">partner</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="c1">// tell Visual Studio about the pair
</span>    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<blockquote>
  <p>The <code class="highlighter-rouge">Source</code> class has a helpful <code class="highlighter-rouge">GetPositionOfLineIndex</code> method, which translates between a Line and Column to a single string index. Very handy!</p>
</blockquote>

<p>Once you’ve got your indices, we need to inform Visual Studio of our findings. You do that by setting the <code class="highlighter-rouge">request.Sink.FoundMatchingBrace</code> to <code class="highlighter-rouge">true</code>, then calling the <code class="highlighter-rouge">MatchPair</code> method on the Sink. You need to pass two <code class="highlighter-rouge">TextSpan</code> instances to the <code class="highlighter-rouge">MatchPair</code> method; the first is the left brace, and the second the right.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">public</span> <span class="k">override</span> <span class="n">AuthoringScope</span> <span class="nf">ParseSource</span><span class="p">(</span><span class="n">ParseRequest</span> <span class="n">request</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">Reason</span> <span class="p">==</span> <span class="n">ParseReason</span><span class="p">.</span><span class="n">MatchBraces</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="p">...</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">partner</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="c1">// tell Visual Studio about the pair
</span>      <span class="n">request</span><span class="p">.</span><span class="n">Sink</span><span class="p">.</span><span class="n">FoundMatchingBrace</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>

      <span class="kt">int</span> <span class="n">nextLine</span><span class="p">,</span> <span class="n">nextCol</span><span class="p">;</span>

      <span class="n">source</span><span class="p">.</span><span class="nf">GetLineIndexOfPosition</span><span class="p">(</span><span class="n">partner</span><span class="p">.</span><span class="n">Value</span><span class="p">,</span> <span class="k">out</span> <span class="n">nextLine</span><span class="p">,</span> <span class="k">out</span> <span class="n">nextCol</span><span class="p">);</span>

      <span class="n">request</span><span class="p">.</span><span class="n">Sink</span><span class="p">.</span><span class="nf">MatchPair</span><span class="p">(</span>
        <span class="k">new</span> <span class="n">TextSpan</span>
        <span class="p">{</span>
          <span class="n">iStartLine</span> <span class="p">=</span> <span class="n">request</span><span class="p">.</span><span class="n">Line</span><span class="p">,</span>
          <span class="n">iEndLine</span> <span class="p">=</span> <span class="n">request</span><span class="p">.</span><span class="n">Line</span><span class="p">,</span>
          <span class="n">iStartIndex</span> <span class="p">=</span> <span class="n">request</span><span class="p">.</span><span class="n">Col</span><span class="p">,</span>
          <span class="n">iEndIndex</span> <span class="p">=</span> <span class="n">request</span><span class="p">.</span><span class="n">Col</span>
        <span class="p">},</span> 
        <span class="k">new</span> <span class="n">TextSpan</span>
        <span class="p">{</span>
          <span class="n">iStartLine</span> <span class="p">=</span> <span class="n">nextLine</span><span class="p">,</span>
          <span class="n">iEndLine</span> <span class="p">=</span> <span class="n">nextLine</span><span class="p">,</span>
          <span class="n">iStartIndex</span> <span class="p">=</span> <span class="n">nextCol</span><span class="p">,</span>
          <span class="n">iEndIndex</span> <span class="p">=</span> <span class="n">nextCol</span> <span class="p">+</span> <span class="m">1</span>
        <span class="p">},</span> <span class="m">0</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="k">new</span> <span class="nf">AuthoringScope</span><span class="p">();</span> <span class="c1">// replace with your implementation
</span>  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<blockquote>
  <p>The <code class="highlighter-rouge">Source</code> class has another helpful method: <code class="highlighter-rouge">GetLineIndexOfPosition</code> method, which translates back to Line and Column from a single string index.</p>
</blockquote>

<p>Finally, just return an empty AuthoringScope, as it isn’t used as part of this parse request.</p>

<p>That’s it! You should have now successfully implemented brace matching. You may need to tweak the TextSpan indexes depending on your parser implementation, but it shouldn’t be far wrong.</p>

<h2 id="boolangstudio-implementation">BooLangStudio implementation</h2>

<p>If you’re interested in seeing how I handle the brace parsing, I may cover that in a future post. However, you can find all the source in my <a href="http://github.com/jagregory/boolangstudio/tree/master">github BooLangStudio fork</a>. Some interesting one’s in particular are:</p>

<ul>
  <li><a href="http://github.com/jagregory/boolangstudio/tree/54d4bcef79d4dbd2ff6cf1fbd9b0a15f325f5c41/Source/BooLangService/ParseRequestProcessor.cs#L133">ParseRequestProcessor.HighlightBraces</a> - Delegated to from the LanguageService.ParseSource method.</li>
  <li><a href="http://github.com/jagregory/boolangstudio/tree/54d4bcef79d4dbd2ff6cf1fbd9b0a15f325f5c41/Source/BooLangService/StringParsing/BracketPairFinder.cs">BracketPairFinder</a> - Class which parses a document to get all the bracket pairs. Uses <a href="http://github.com/jagregory/boolangstudio/tree/54d4bcef79d4dbd2ff6cf1fbd9b0a15f325f5c41/Source/BooLangService/StringParsing/ExcludingStringLiteralsStringWalker.cs">ExcludingStringLiteralsStringWalker</a>.</li>
  <li><a href="http://github.com/jagregory/boolangstudio/tree/54d4bcef79d4dbd2ff6cf1fbd9b0a15f325f5c41/Source/BooLangService/StringParsing/StringWalker.cs">StringWalker</a> - A simple string parser used by the <code class="highlighter-rouge">BracketPairFinder</code>, which walks over a string maintaining a code-aware state. Basically, it lets you know whether it’s currently inside a bracket or string literal. Handy for not matching characters inside strings.</li>
</ul>

 <a class="read-more" href="/writings/brace-matching-and-your-language-service">Read more &raquo;</a>
        </section>
        <footer class="post-meta">
            
            
            <time class="post-date" datetime="2008-09-02">
                02 Sep 2008
            </time>
        </footer>
    </article>

    

    <article class="post">
        <header class="post-header">
            <h2 class="post-title"><a href="/writings/time-time-time">Time, time, time</a></h2>
        </header>
        <section class="post-excerpt">
            <p>Time is a funny thing, a day can drag out and feel like an eternity, but a year can pass in a blink of an eye.</p>

<p>I’m about 8,395 days old today, that’s roughly 201,480 rotations of the hour hand of your clock. Remember how long it takes for that hour hand to drip by while you’re in yet another boring meeting? I’ve had over 201 thousand of them.</p>

<p>That all equates to 23 years old, which isn’t too bad I suppose.</p>

<p>It’s not often I talk about myself. I have a lot of opinions, but I generally keep me to myself. On this occasion I’m going to give myself a pat on the back.</p>

<p><strong>I’m pretty proud of myself.</strong></p>

<p>I have no qualifications, I have no A-levels, and only a few GCSEs. I am completely self-taught.</p>

<p>One thing that I’ve learnt is that only you know yourself. If somebody says you can’t do something, fuck them. Who are they to tell you what you can and can’t do? Prove them wrong.</p>

<p>I was told that programming is hard, and it’s not something you can learn in your bedroom any more. I was told I’d not be earning more than £14,000 by the time I was 20. I was told there was no chance I could get a job without any formal qualifications. Two jobs down the line, too many languages to list, and more money than sense - I think I proved them all wrong.</p>

<p>The best thing you can do for yourself is to learn how to learn. It’s the one thing they don’t teach you in school. Since I learnt how to learn, I’ve gained so much knowledge.</p>

<p>Don’t concern yourself with the details, learn the techniques, learn the principals. It can be mistaken for arrogance, but I’m so confident in my ability to <em>learn</em>, that I can safely say that I can use <strong>any programming language</strong>, any operating system, any technology, ever invented and ever to be invented.</p>

<p>I am not scared of change, of new technologies, and I’m not afraid of being left behind. I can adapt, because I can learn.</p>

<p>It’s been a crazy ride so far, I look forward to what the next few years bring.</p>

 <a class="read-more" href="/writings/time-time-time">Read more &raquo;</a>
        </section>
        <footer class="post-meta">
            
            
            <time class="post-date" datetime="2008-08-14">
                14 Aug 2008
            </time>
        </footer>
    </article>

    

    <article class="post">
        <header class="post-header">
            <h2 class="post-title"><a href="/writings/introducing-fluent-nhibernate">Introducing Fluent NHibernate</a></h2>
        </header>
        <section class="post-excerpt">
            <blockquote>
  <p>A couple of people have already covered this already, specifically <a href="http://www.IAmNotMyself.com/2008/08/07/SkinningTheCatWithFluentNHibernate.aspx">Bobby Johnson</a>, <a href="http://mhinze.com/fluent-nhibernate-project/">Matt Hinze</a>, and <a href="http://zachariahyoung.com/zy/post/2008/08/fluent-nhibernate-for-creating-entity-mapping-files.aspx">Zachariah Young</a>. I figure I should say something on it anyway.</p>
</blockquote>

<p>I’ve adopted a project from <a href="http://codebetter.com/blogs/jeremy.miller/">Jeremy Miller</a> that I think has the potential to be a really useful tool. It’s called <a href="http://www.fluentnhibernate.org">Fluent NHibernate</a>, and it’s primarily a fluent API for mapping classes with NHibernate.</p>

<p>We’re all well aware how awesome NHibernate is, but I think we all also have a bit of a dislike for the amount of XML you need to write to get your classes mapped; not only that, but also how the mappings are distinctly separate from the rest of your application. They’re often neglected and untested. One of the core tenets of the project is that we need a more succinct, readable, and testable way of writing your mappings.</p>

<h2 id="the-api">The API</h2>

<p>Take the following simple hbm file:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="utf-8" ?&gt;</span>
<span class="nt">&lt;hibernate-mapping</span> <span class="na">xmlns=</span><span class="s">"urn:nhibernate-mapping-2.2"</span> <span class="na">namespace=</span><span class="s">"Eg"</span> <span class="na">assembly=</span><span class="s">"Eg"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;class</span> <span class="na">name=</span><span class="s">"Customer"</span> <span class="na">table=</span><span class="s">"Customers"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;id</span> <span class="na">name=</span><span class="s">"ID"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;generator</span> <span class="na">class=</span><span class="s">"identity"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/id&gt;</span>

    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"Name"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"Credit"</span> <span class="nt">/&gt;</span>

    <span class="nt">&lt;bag</span> <span class="na">name=</span><span class="s">"Products"</span> <span class="na">table=</span><span class="s">"Products"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;key</span> <span class="na">column=</span><span class="s">"CustomerID"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;one-to-many</span> <span class="na">class=</span><span class="s">"Eg.Product, Eg"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/bag&gt;</span>

    <span class="nt">&lt;component</span> <span class="na">name=</span><span class="s">"Address"</span> <span class="na">class=</span><span class="s">"Eg.Address, Eg"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"AddressLine1"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"AddressLine2"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"CityName"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"CountryName"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/component&gt;</span>
  <span class="nt">&lt;/class&gt;</span>
<span class="nt">&lt;/hibernate-mapping&gt;</span>
</code></pre>
</div>

<p>Then compare it to the same mapping, created using the fluent API:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">public</span> <span class="n">CustomerMap</span> <span class="p">:</span> <span class="n">ClassMap</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;</span>
<span class="p">{</span>
  <span class="k">public</span> <span class="nf">CustomerMap</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="nf">Id</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">ID</span><span class="p">);</span>
    <span class="nf">Map</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">Name</span><span class="p">);</span>
    <span class="nf">Map</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">Credit</span><span class="p">);</span>
    <span class="n">HasMany</span><span class="p">&lt;</span><span class="n">Product</span><span class="p">&gt;(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">Products</span><span class="p">)</span>
      <span class="p">.</span><span class="nf">AsBag</span><span class="p">();</span>
    <span class="n">Component</span><span class="p">&lt;</span><span class="n">Address</span><span class="p">&gt;(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">Address</span><span class="p">,</span> <span class="n">m</span> <span class="p">=&gt;</span>
    <span class="p">{</span>  
        <span class="n">m</span><span class="p">.</span><span class="nf">Map</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">AddressLine1</span><span class="p">);</span>  
        <span class="n">m</span><span class="p">.</span><span class="nf">Map</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">AddressLine2</span><span class="p">);</span>  
        <span class="n">m</span><span class="p">.</span><span class="nf">Map</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">CityName</span><span class="p">);</span>  
        <span class="n">m</span><span class="p">.</span><span class="nf">Map</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">CountryName</span><span class="p">);</span>  
    <span class="p">});</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Firstly, you’ll note that there is a marginal reduction in lines of code, but that’s not what we’re particularly striving for. Instead we’re intent on reducing the verbosity and <strong>noise</strong> of the code. This manifests itself in a <a href="http://en.wikipedia.org/wiki/Convention_over_Configuration">convention over configuration</a> design for the API, where we choose the most common setups and use those as the default. For example with the <code>id</code> element in the hbm file, you’re required to specify what the generator type is; however, in our fluent API we check the type of your identity property and decide what generator we should use. Int’s and longs default to identity, while GUIDs use the guid.comb generator. You can change these explicitly, but when you are using the default, it greatly reduces the verbosity of your mapping.</p>

<h2 id="testability">Testability</h2>

<p>Another one of our goals is to make your mappings more robust. I imagine most people have had the problem where you’ve renamed a property and not updated the mapping file; due to there being no compile time validation, the only way to catch these mistakes are at run time (hopefully you had tests to cover that!). With the way our API is designed, you use the actual properties on your classes to create the mapping, so there’s nothing to forget. If you rename a property, your IDE will either rename the property in the mapping, or fail at compilation.</p>

<p>We also want to help you verify that your mappings are set up properly, not just syntactically valid. So to make your 	integration tests a bit easier, we’re providing an API for testing your mappings.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="na">[Test]</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">VerifyCustomerSaves</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">new</span> <span class="n">PersistenceSpecification</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;()</span>
        <span class="p">.</span><span class="nf">CheckProperty</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span> <span class="s">"James Gregory"</span><span class="p">)</span>
        <span class="p">.</span><span class="nf">CheckProperty</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">Age</span><span class="p">,</span> <span class="m">22</span><span class="p">)</span>
        <span class="p">.</span><span class="nf">VerifyTheMappings</span><span class="p">();</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Behind the scenes the <code>PersistenceSpecification</code> creates an instance of your entity, then populates it with the values you specify through the <code>CheckProperty</code> method. This entity is then saved to the database, then reloaded through a separate connection. The returned entity is then compared to the one originally saved, and any differences fail the test. It’s a fairly standard integration test, except we’ve taken the time to write all the wiring up that needs to be done, so you don’t have to.</p>

<h2 id="the-framework">The Framework</h2>

<p>We’re working towards our first official release, which will have a fairly solid implementation of the API. Once that’s out in the wild, we’re going to focus on our Framework.</p>

<p>Our framework is a layer that sits on-top of the API to provide an even better experience. We’re looking to integrate with your favorite container, which will reduce the code you need to write to integrate NHibernate into your system. Then we’re going to tackle extensible conventions, which will allow you to specify your own implied conventions for your application. For example, if you’re <strong>always</strong> going to call your identifier “ID”, then why should you have to specify it every time? <em>You shouldn’t!</em></p>

<p>Development is progressing at a nice pace, and I expect we’ll be able to get our first release out within the next few weeks. The testing API hasn’t been kept quite as up to date as the main API, but we’re working on that too. It’s open-source, so suggestions and patches are welcome.</p>

 <a class="read-more" href="/writings/introducing-fluent-nhibernate">Read more &raquo;</a>
        </section>
        <footer class="post-meta">
            
            
            <time class="post-date" datetime="2008-08-08">
                08 Aug 2008
            </time>
        </footer>
    </article>

    

    <article class="post">
        <header class="post-header">
            <h2 class="post-title"><a href="/writings/latest-on-boolangstudio">Latest on BooLangStudio</a></h2>
        </header>
        <section class="post-excerpt">
            <p>It’s been a long time since I’ve written anything about <a href="http://www.codeplex.com/BooLangStudio">BooLangStudio</a>. Let me assure you that the development is still very much underway, and we’re steadily working towards our first release.</p>

<p>To fill you in a bit on what’s been going on. Jeffery Olson has completely rewritten the syntax highlighting to use the more flexible Boo.Pegs lexer, which allows us to overcome some of the obstacles we were facing with the traditional Boo lexer. There were limitations to what we could do with the traditional lexer, without modifying the Boo source. This was leading us down a road we weren’t keen on, one of maintaining a fork of the Boo source that contained our specific changes. With the move to the Boo.Pegs lexer, we’re free of this scenario!</p>

<p><img src="/images/bls-1.png" alt="Syntax highlighting" /></p>

<p><a href="http://www.justnbusiness.com/">Justin Chase</a> has been tackling various issues all over the place. Several related to the build process, specifically how the Boo binaries are located on your machine, which has been a bit of a problem when there’s multiple developers working on a project whom both have Boo installed in a different location. He’s also been spiffing up the interface by adding some much needed icons to the projects.</p>

<p><img src="/images/bls-2.png" alt="Project view" /></p>

<p><a href="http://www.codinginstinct.com/">Torkel Ödegaard</a> has been working various issues throughout the project. He’s created a properties dialog for the project which allows you to alter the usual settings for your project, assembly name, default namespace etc… He also managed to get debugging working, which is awesome.</p>

<p>Then there’s me, I’ve been working on the intellisense capabilities. We’ve had intellisense support from day one, but it’s never been very extensive. For a long time it only worked on the current file you had open.</p>

<p>The entire solution is now processed behind-the-scenes to provide intellisense. Import statements are now recognised and imported types appear in the local scope intellisense. Any assemblies or projects that are referenced have their top-level types and namespaces included in the intellisense too.</p>

<p>Additionally I’ve been working on improving the method suggestion logic, which was initially very flakey. It boils down to being able to transform the current line into the desired type, which can be difficult in certain cases (<code>StringBuilder().Append("Hello world").ToString().</code> for example).</p>

<p><img src="/images/bls-3.png" alt="Code completion" /></p>

<p>I believe that about covers what we’ve been upto lately. Our biggest problem currently is that most of these features are implemented in separate branches, and haven’t yet been merged into our central repository. We’re working on this, and I reckon once we’ve done that we’ll be looking at doing a release.</p>

 <a class="read-more" href="/writings/latest-on-boolangstudio">Read more &raquo;</a>
        </section>
        <footer class="post-meta">
            
            
            <time class="post-date" datetime="2008-08-07">
                07 Aug 2008
            </time>
        </footer>
    </article>

    

    <article class="post">
        <header class="post-header">
            <h2 class="post-title"><a href="/writings/missed-out-on-something-big">Missed out on something big</a></h2>
        </header>
        <section class="post-excerpt">
            <p>Ever get the feeling that you’ve missed out on something big? I never got to see Star Wars at the cinema. I missed out on the start of computers, the ASM, the BASIC hacking and what-not. I discovered most of my musical taste way after the bands were gone or going, so I never got to see them in show.</p>

<p>None of those are my fault, of course, because they were all before my time; in fact, most were at least a decade before me. That still doesn’t stop me from ocasionally getting the feeling that I missed out on something big.</p>

<p>One more. One that’s pertient to our industry: Smalltalk.</p>

<p>Smalltalk is one of those languages, possibly the most prominent example, that has been idolised over time. It’s often touted as having an excellent programmer experience, properly object-oriented, the source of refactoring, great tools, and a solid virtual machine behind it. It’s one of those languages that people are proud to say they once worked with it. A language that people nosalgicly look back on. It’s also got an air of betamax about it (yeah, I missed that one too), people were sure it was better, but it still didn’t become mainstream.</p>

<blockquote>
  <p>“We Smalltalkers used to think the advantages of our language were so significant that it would take over the world. We had a huge productivity advantage over C coders. Then C++ came along and gave C coders just enough to let them improve their productivity and their ability to write larger more complex systems. It still wasn’t as good as Smalltalk, but it was better than C, and much more accessible to most programmers than Smalltalk.” - <a href="http://blog.hasmanythrough.com/2008/5/31/quick-railsconf-update">Josh Susser</a> via <a href="http://weblog.raganwald.com/2008/06/bit-of-history-and-interesting.html">Raganwald</a></p>
</blockquote>

<p>So where am I going with this? Just like I can make myself feel a bit better by watching Star Wars on a large TV, or listening to the Rolling Stones live albums. I’d like to see what all the fuss was about with Smalltalk, by giving it a go.</p>

<p>I’m not sure where to start on this, or how long it’s going to take, or even when I’m going to do it; however, one day in the not too distant future I’m going to do some programming with Smalltalk.</p>

 <a class="read-more" href="/writings/missed-out-on-something-big">Read more &raquo;</a>
        </section>
        <footer class="post-meta">
            
            
            <time class="post-date" datetime="2008-07-01">
                01 Jul 2008
            </time>
        </footer>
    </article>

    

    <nav class="pagination" role="pagination">
    
        
            <a class="newer-posts" href="/page10/" title="Previous Page">&laquo; Newer Posts</a>
      
    
    <span class="page-number"> Page 11 of 23 </span>
     
        <a class="older-posts" href="/page12/" title="Next Page">Older Posts &raquo;</a>
     
</nav>

</main>

    <footer class="site-footer clearfix">
      <section class="copyright">
        <a href="mailto:james@jagregory.com">James Gregory</a> &copy;
               &bull; All content licensed under <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">cc by-nc-sa 4.0</a>.
      </section>
    </footer>

    <script type="text/javascript" src="/js/jquery-1.11.1.min.js"></script>
    <script type="text/javascript" src="/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="/js/index.js"></script>
</body>
</html>
