<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

    <title>James Gregory</title>
    <meta name="description" content="Code monkey. ThoughtWorks. Chief Agitator.
" />

    <meta name="HandheldFriendly" content="True" />
    <meta name="MobileOptimized" content="320" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css" href="/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400" />
    <!-- Customisation  -->
    <link rel="stylesheet" type="text/css" href="/css/main.css" />

</head>
<body class="home-template">

    <header class="main-header no-cover">
    <div class="vertical">
        <div class="main-header-content inner">
            <h1 class="page-title"><a href="/">James Gregory</a></h1>
            <h2 class="page-description">
                 Code monkey. ThoughtWorks. Chief Agitator.
 
            </h2>
        </div>
    </div>
    <a class="scroll-down icon-arrow-left" href="#content" data-offset="-45"><span class="hidden">Scroll Down</span></a>
</header>

<main id="content" class="content" role="main">
    <div class="extra-pagination inner">
        <nav class="pagination" role="pagination">
    
        
            <a class="newer-posts" href="/page4/" title="Previous Page">&laquo; Newer Posts</a>
      
    
    <span class="page-number"> Page 5 of 23 </span>
     
        <a class="older-posts" href="/page6/" title="Next Page">Older Posts &raquo;</a>
     
</nav>
    </div>

    

    <article class="post">
        <header class="post-header">
            <h2 class="post-title"><a href="/writings/whats-been-happening-in-fluent-nhibernate-land">What's been happening in Fluent NHibernate land?</a></h2>
        </header>
        <section class="post-excerpt">
            <blockquote>
  <p>Cross-posted to <a href="http://jagregory.lostechies.com/archive/2009/04/28/what-s-been-happening-in-fluent-nhibernate-land.aspx">Los Techies</a>&lt;/blockquote&gt;</p>

  <p><a href="http://www.fluentnhibernate.org">Fluent NHibernate</a> has seen a flurry of development followed by a complete lack of commits, I figure it’s time to let everyone know what’s going on.</p>

  <p><strong>The Short Version</strong></p>

  <p>We’re rewriting the internals. We have 100% of tests passing, but still can’t guarantee no regressions. Stuff may break, if it does, <a href="http://groups.google.com/group/fluent-nhibernate">tell us</a>. It’ll be worth it.</p>

  <p><strong>The Long Version</strong></p>

  <p>Once upon a time…</p>

  <p>Fluent NHibernate at it’s core is a fluent interface over xml generation. We use the series of methods you call in your mappings to build up an in-memory hbm xml document that we then feed to NHibernate. Slowly, as we’ve started to support more and more of NHibernate’s features, we’ve started to find flaws in our architecture. It amounts to us not having enough separation of concerns; our fluent interface is generating xml, I think most people would say that’s not a good thing. Our xml is being generated too soon in the cycle to allow us to do more clever things that’d improve the user’s experience. That’s where the quiet time comes in.</p>

  <p><a href="http://www.paulbatum.com">Paul Batum</a> undertook the task of redesigning the internals of Fluent NHibernate to be something much more scalable. I’ll leave the details out for now (maybe a future post), but it amounts to a intermediary layer being introduced between the fluent interface and the xml generation. We’ve dubbed this the Semantic Model, and it’s that which is now generated by the fluent interface, then later translated into xml. This added abstraction allows us to do things that weren’t possible while we were just generating straight xml.</p>

  <p>Whilst you wont see any immediate improvements while everything is being converted, the extra layer allows us to inspect the model before it is converted to xml; this gives us some immense capabilities, such as allowing subclasses to be separate from their parent mapping, create reusable component mappings, improve relationship support etc… We’re pretty much limited only by what we can imagine now, rather than by architectural decisions.</p>

  <p>However, we have a dilemma. The semantic-model branch has deviated so much from trunk we’ve got a major merge problem. A merge is pretty much out of the question actually, because there’s barely any commonality between the two streams at all. It was then assumed that the branch would eventually replace trunk (we’d just rename trunk to a tag, then rename the semantic-model branch to trunk), and all we needed to do was get the branch up-to-date with the features of trunk. Little did we realise we were essentially committing to something that I typically oppose, a complete rewrite! I’ve never been in a situation where that’s ever been a good idea, and yet here we are, responsible for our own destiny as it was, and we’d chosen a rewrite!</p>

  <p>A few weeks went by with very little work happening. I think we’d all started feeling demoralised by the idea of re-implementing most of the features from trunk using the new design. It was a worthwhile endeavor, definitely, but just very uninteresting. We repeatedly swore that we’d get this done, but all the while we felt less inclined to support trunk because every new feature meant a new feature to port too. We stopped.</p>

  <p>At that point <a href="http://www.bestguesstheory.com/">Hudson Akridge</a>, our newest contributor, had the balls to tell me that he thought what we were doing felt pretty futile. At that moment I gained a great deal of respect for him, as it’s something that was in the back of my mind for some time but I wasn’t ready to face yet. It was that which got me moving again.</p>

  <p>I sat down over a long weekend and took on the mammoth task of merging our rewrite branch and trunk, with the aim of allowing the existing code to exist alongside the new code; this approach, if it worked, would allow us to convert existing features at our own pace while still writing new features for the cleaner codebase. After a lot of unpleasant hacking of nice code, I managed to get all our existing tests passing while utilising the semantic model behind the scenes. Our old code still directly generates xml, which then gets injected into the semantic model via a nasty shortcut. It feels dirty, because I’ve had to comprimise some good code to get it working, but in a way I think that’s a good thing; if code is nasty, we’re all less likely to be content with it. The main goal was achieved though, and that was to allow us to work at our own pace on trunk.</p>

  <p>Where we stand now is three branches, trunk, integration, and semantic-model. Over the next day or so I am going to merge integration with trunk, which will mean the semantic model will be in use for new features. From there we can slowly migrate all the original code to use our new semantic model, all the while adding new features using it, then eventually remove the duct-tape that’s holding the legacy code to the new code and dump the old stuff.</p>

  <p>This is where I’ll give you a little warning: although we have 100% of tests passing, we don’t have 100% coverage. There may be some regressions that we aren’t aware of. If anyone finds anything broken that was working before, contact us immediately on the <a href="groups.google.com/group/fluent-nhibernate">mailing list</a> or via the <a href="http://code.google.com/p/fluent-nhibernate/issues/list">issues list</a> and we’ll correct it. Regressions will be treated with the highest priority over any other work.</p>

  <p>That’s it, you now know more about what’s happening with Fluent NHibernate than you ever wanted to. I hope this sheds a little light onto what’s been happening with us, and perhaps why your patch hasn’t been applied as quickly as you would’ve liked.</p>

</blockquote>
 <a class="read-more" href="/writings/whats-been-happening-in-fluent-nhibernate-land">Read more &raquo;</a>
        </section>
        <footer class="post-meta">
            
            
            <time class="post-date" datetime="2009-04-28">
                28 Apr 2009
            </time>
        </footer>
    </article>

    

    <article class="post">
        <header class="post-header">
            <h2 class="post-title"><a href="/writings/im-a-los-techie">I'm a Los Techie</a></h2>
        </header>
        <section class="post-excerpt">
            Just to let anyone know that hasn't heard by other means, I'm now blogging at <a href="http://lostechies.com">Los Techies</a>. I'm going to cross-post between these two blogs, so there's no need to update your feeds if you're too lazy; but if you're already subscribing to the Los Techies general feed then you'll now get me too.

You can find my blog at: <a href="http://jagregory.lostechies.com">jagregory.lostechies.com</a>


 <a class="read-more" href="/writings/im-a-los-techie">Read more &raquo;</a>
        </section>
        <footer class="post-meta">
            
            
            <time class="post-date" datetime="2009-03-28">
                28 Mar 2009
            </time>
        </footer>
    </article>

    

    <article class="post">
        <header class="post-header">
            <h2 class="post-title"><a href="/writings/fluent-nhibernate-usage-stats">Fluent NHibernate usage stats</a></h2>
        </header>
        <section class="post-excerpt">
            Just been totting up some figures on how <a href="http://fluentnhibernate.org">Fluent NHibernate</a> is doing, thought I'd share them with anyone that's interested.

<blockquote>These are very rough figures, generated with no scientific consistency, some are cumulative and others are based just on the last full month. They're more just to satisfy my curiosity than to be rigorously accurate.</blockquote>

<table>
  <tr>
    <td>Downloads</td>
    <td>1,800 per month</td>
  </tr>
  <tr>
    <td>Unique visitors</td>
    <td>5,500 per month</td>
  </tr>
  <tr>
    <td>Page views</td>
    <td>13,000 per month</td>
  </tr>
  <tr>
    <td>Mailing list messages</td>
    <td>450 per month</td>
  <tr>
    <td>Commits</td>
    <td>45 per month</td>
  </tr>
</table>

Something else that's interesting is of those 5,500 visitors/13,000 page views, 66% are coming directly from google, 4% directly, then the other 30% from referrers. Those referrers are broken down into (from highest to lowest): <a href="http://stackoverflow.com">Stack Overflow</a>, <a href="http://blog.jagregory.com">my blog</a>, <a href="http://pnpguidance.net">pnpguidance.net</a>, <a href="http://nhforge.org">nhforge</a>, then quite a few other sites forming the lower percentages. I'm surprised at how high Stack Overflow is, I guess it pays that I pay attention to questions asked about Fluent on there.

Those download numbers are probably not representative either as they're only of the zip files, while I believe the vast majority of people run off the trunk through Subversion, so it's hard to count them.


 <a class="read-more" href="/writings/fluent-nhibernate-usage-stats">Read more &raquo;</a>
        </section>
        <footer class="post-meta">
            
            
            <time class="post-date" datetime="2009-03-21">
                21 Mar 2009
            </time>
        </footer>
    </article>

    

    <article class="post">
        <header class="post-header">
            <h2 class="post-title"><a href="/writings/docu-2-days">Docu + 2 days</a></h2>
        </header>
        <section class="post-excerpt">
            <p>It’s been two days since I <a href="/writings/introducing-docu-simple-doc-gen-for-net/">announced</a> <a href="http://docu.jagregory.com">docu</a>, my simple documentation generator for .Net apps.</p>

<p>The reception it’s received has been positive, I never expected it to have a surge of popularity because it’s not that kind of tool, so it hasn’t come as much of a surprise that people haven’t been jumping all over it. Having said that though, I have had some good feedback and already someone has contributed a patch. Additionally, there hasn’t been one question as to why I’ve created it; now this has come as a surprise, I guess I’m <strong>not</strong> the only one that feels Sandcastle is bloated and overcomplicated. Yay!</p>

<p>I’ve just pushed out some changes to the <a href="http://github.com/jagregory/docu">github repos</a> and released an updated alpha (v0.1.0.2) on the <a href="http://docu.jagregory.com/downloads">downloads page</a>. The biggest changes so far are the inclusion of events and fields in the parsing, which now means docu has <code>&lt;summary /&gt;</code> support for all documentable members. The rest of the changes are mainly refactorings and some battle-hardening.</p>

<p>I’ve got some more changes and several issues lined up, so keep an eye out.</p>

 <a class="read-more" href="/writings/docu-2-days">Read more &raquo;</a>
        </section>
        <footer class="post-meta">
            
            
            <time class="post-date" datetime="2009-03-21">
                21 Mar 2009
            </time>
        </footer>
    </article>

    

    <article class="post">
        <header class="post-header">
            <h2 class="post-title"><a href="/writings/introducing-docu-simple-doc-gen-for-net">Introducing Docu - Simple doc gen for .Net</a></h2>
        </header>
        <section class="post-excerpt">
            <p>Lets look at a recent Twitter conversation of mine:</p>

<ul>
<li>Anyone have any tips on generating html docs from XML comments? Used to do it years ago with NDoc <a href='http://twitter.com/jagregory/status/1312895270'>?</a></li>

<li>Man, sandcastle is so overly complex <a href='http://twitter.com/jagregory/status/1313079815'>?</a></li>

<li>Sandcastle examples don&#8217;t even work. This is shit. <a href='http://twitter.com/jagregory/status/1313167377'>?</a></li>

<li>Why isn&#8217;t sandcastle just a console app that takes a list of dlls and spits out html/chm? What&#8217;s with all the batch files and XslTransforms? <a href='http://twitter.com/jagregory/status/1313112789'>?</a></li>

<li>@AndrewNStewart Well Sandcastle requires chaining together several calls to 3+ applications before you get anything. <a href='http://twitter.com/jagregory/status/1315443964'>?</a></li>

<li>Are these Sandcastle generated MSDN-style API docs actually useful to anyone? <a href='http://twitter.com/jagregory/status/1315364767'>?</a></li>

<li>@pollingj It&#8217;s a dilemma. I don&#8217;t care about API docs, but people seem to want it, but I&#8217;m reluctant to generate msdn-like shit. Dilemma. <a href='http://twitter.com/jagregory/status/1315455082'>?</a></li>
</ul>

<p>So as you can see, dilemma. People want API documentation (for <a href='http://fluentnhibernate.org'>Fluent NHibernate</a> specifically), but I don&#8217;t want to associate myself with the awful MSDN-style documentation that&#8217;s produced by Sandcastle.</p>

<blockquote>
<p>Before you get all hot under the collar, if you like Sandcastle, or you like MSDN-style documentation, leave now. Use what works for you, it doesn&#8217;t work for me so I&#8217;m not using it, but I don&#8217;t want to stop you using it.</p>

<p>I realise the market for this tool is probably pretty small, but it&#8217;s useful to me so it might be useful to you.</p>
</blockquote>

<p>Introducing <a href='http://docu.jagregory.com'>docu</a>, the simple documentation generator for .Net!</p>

<p>Docu is a tool that produces an html site (or rather, a collection of html pages) from the doc-comments you include in your code. Given an assembly and the Visual Studio produced XML of the comments, docu will produce a completely static collection of pages that you can publish anywhere you like. You run it through one command-line tool, with one parameter. That&#8217;s it, nothing complicated.</p>

<p><code style="background: #CCC;color: #000;padding: 2px;">docu your-assembly.dll</code></p>

<p>You can see an example of the default style that&#8217;s provided in the Fluent NHibernate <a href='http://fluentnhibernate.org/api/index.htm'>API docs</a> (the colour scheme has been modified, but everything else is default).</p>

<p>Docu is completely stand alone, no GAC deployed assemblies, no hard-coded paths, no nothing. This makes it trivial to use docu in your CI process for building up-to-the-second API docs for publishing or downloading.</p>

<p>The templates that docu uses are created with the <a href='http://sparkviewengine.com'>Spark view engine</a> which means you have all the power of C# and it&#8217;s templating language at your finger-tips. If you&#8217;re particularly picky about appearance (like I am) then you can completely rewrite the templates to your heart&#8217;s content. There&#8217;s no imposed structure or style, it&#8217;s all customisable through the templates. You can read more about customising templates on the site: <a href='http://docu.jagregory.com/customising-templates'>customising templates</a>.</p>

<p>An interesting little feature of the templating system is <em>special names</em> for directories and files, for example if you name a template <code>!namespace.spark</code>, a html page will be produced for a each namespace in your assembly using that template. This allows you to do things like create a directory for each namespace, with a page for each type in that namespace inside. Pretty powerful!</p>

<p>The codebase is reasonably well structured, but the code itself is a bit untidy. Luckily it&#8217;s covered by nearly 200 unit tests (so far) and i&#8217;ll be leveraging them to improve the code quality over time. You can checkout the code from the <a href="http://github.com/jagregory/docu">docu github repo</a>.</p>

<p>It's early days yet, there's very little customisation of the documentation process (the part that actually finds the types and members to document), and not all comment types are supported yet; however, it's used for Fluent NHibernate and works pretty well. It's only Alpha right now, so you shouldn't expect the world.</p>

<p>So if this kind-of thing interests you, go have a read of the <a href='http://docu.jagregory.com'>docu website</a> and let me know how it works out for you.</p>


 <a class="read-more" href="/writings/introducing-docu-simple-doc-gen-for-net">Read more &raquo;</a>
        </section>
        <footer class="post-meta">
            
            
            <time class="post-date" datetime="2009-03-19">
                19 Mar 2009
            </time>
        </footer>
    </article>

    

    <nav class="pagination" role="pagination">
    
        
            <a class="newer-posts" href="/page4/" title="Previous Page">&laquo; Newer Posts</a>
      
    
    <span class="page-number"> Page 5 of 23 </span>
     
        <a class="older-posts" href="/page6/" title="Next Page">Older Posts &raquo;</a>
     
</nav>

</main>

    <footer class="site-footer clearfix">
      <section class="copyright">
        <a href="mailto:james@jagregory.com">James Gregory</a> &copy;
               &bull; All content licensed under <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">cc by-nc-sa 4.0</a>.
      </section>
    </footer>

    <script type="text/javascript" src="/js/jquery-1.11.1.min.js"></script>
    <script type="text/javascript" src="/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="/js/index.js"></script>
</body>
</html>
