
<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <title>Compiled Templates for Go - James Gregory</title>
    <meta name="author" content="James Gregory">

    
    <meta name="description" content="Compiled Templates for Go Cote is a compiled templating language for Go. Template languages fall roughly into two criteria: template specific &hellip;">
    
    <meta name="viewport" content="width=device-width; initial-scale=1; maximum-scale=1">

    <link href="/atom.xml" rel="alternate" title="James Gregory" type="application/atom+xml">
    <link rel="canonical" href="">
    <link href="/favicon.png" rel="shortcut icon">
    <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
    
    <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    
    
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-3186192-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body>
	<header class="inner"><h1 class="left"><a href="/">James Gregory</a></h1>
<nav class="menu left"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
</ul>
</nav>
<div class="right">
	<form class="search right" action="http://google.com/search" method="get">
		<input class="left" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:www.jagregory.com">
	</form>
	<div class="social right">
		
		
		
		
		<a class="github" href="https://github.com/jagregory" title="GitHub">GitHub</a>
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
	</div>
</div>

</header>
	
	<div id="content" class="inner"><article class="post">
    <h1 class="title">Compiled Templates for Go</h1>
    <div class="entry"><p><a href="https://github.com/jagregory/cote">Cote</a> is a compiled templating language for <a href="http://golang.org">Go</a>.</p>

<!-- more -->


<p>Template languages fall roughly into two criteria: template specific language or the same language your system uses, and a custom markup language or they don&#8217;t care. <a href="https://github.com/jagregory/cote">Cote</a> falls into the second of both criteria, it uses pure Go for logic and the content can be anything. Your output can be anything text based.</p>

<table>
  <thead>
    <tr>
      <th></th>
      <th>Custom code?</th>
      <th>Custom markup?</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>ERB</td>
      <td>No</td>
      <td>No</td>
    </tr>
    <tr>
      <td>HAML</td>
      <td>No</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td>Jade</td>
      <td>No</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td>Go html/template</td>
      <td>Yes</td>
      <td>No</td>
    </tr>
    <tr>
      <td>_.template</td>
      <td>No</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Cote</td>
      <td>No</td>
      <td>No</td>
    </tr>
  </tbody>
</table>


<p>Cote uses the same tokens as ERB and ASP.Net (and I imagine quite a few other languages), specificically <code>&lt;%= %&gt;</code> for any code which should write to the output stream and <code>&lt;% %&gt;</code> for code which doesn&#8217;t. Inside a code block you can write any valid Go code, outside can be anything.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='erb'><span class='line'><span class="x">&lt;html&gt;</span>
</span><span class='line'><span class="x">  &lt;head&gt;</span>
</span><span class='line'><span class="x">    &lt;title&gt;</span><span class="cp">&lt;%=</span> <span class="n">locals</span><span class="o">.</span><span class="n">Title</span> <span class="cp">%&gt;</span><span class="x">&lt;/title&gt;</span>
</span><span class='line'><span class="x">  &lt;/head&gt;</span>
</span><span class='line'><span class="x">  &lt;body&gt;</span>
</span><span class='line'><span class="x">    &lt;h1&gt;Products&lt;/h1&gt;</span>
</span><span class='line'><span class="x">    &lt;ul&gt;</span>
</span><span class='line'><span class="x">      </span><span class="cp">&lt;%</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="nb">p</span> <span class="p">:</span><span class="o">=</span> <span class="n">range</span> <span class="n">locals</span><span class="o">.</span><span class="n">Products</span> <span class="p">{</span> <span class="cp">%&gt;</span><span class="x"></span>
</span><span class='line'><span class="x">        &lt;li&gt;</span><span class="cp">&lt;%=</span> <span class="nb">p</span><span class="o">.</span><span class="n">Name</span> <span class="cp">%&gt;</span><span class="x">&lt;/li&gt;</span>
</span><span class='line'><span class="x">      </span><span class="cp">&lt;%</span> <span class="p">}</span> <span class="cp">%&gt;</span><span class="x"></span>
</span><span class='line'><span class="x">    &lt;/ul&gt;</span>
</span><span class='line'><span class="x">  &lt;/body&gt;</span>
</span><span class='line'><span class="x">&lt;/html&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>As mentioned previously, Cote templates are compiled. A template is converted into pure Go and compiled into your package. No dependency on Cote is needed outside of your build pipeline. This adds some overhead to development (a template change requires a recompile), but it makes the impact on runtime as minimal as possible.</p>

<p>There&#8217;s an executable (aptly named <code>cote</code>) which will take a template and spit out a Go function which can be called to render the template. Cote uses a very simplistic form of code generation to build your templates. It&#8217;s really simple.</p>

<p>Given the above template, <code>cote</code> would produce a Go file roughly like:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='go'><span class='line'><span class="kn">package</span> <span class="nx">templates</span>
</span><span class='line'>
</span><span class='line'><span class="kd">func</span> <span class="nx">Products</span><span class="p">(</span><span class="nx">locals</span> <span class="nx">ProductsLocals</span><span class="p">)</span> <span class="p">[]</span><span class="kt">byte</span> <span class="p">{</span>
</span><span class='line'>  <span class="c1">// ... snip ...</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">fmt</span><span class="p">.</span><span class="nx">Fprint</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&quot;&lt;html&gt;&lt;head&gt;&lt;title&gt;&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="nx">fmt</span><span class="p">.</span><span class="nx">Fprint</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">locals</span><span class="p">.</span><span class="nx">Title</span><span class="p">)</span>
</span><span class='line'>  <span class="nx">fmt</span><span class="p">.</span><span class="nx">Fprint</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&quot;&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;Products&lt;/h1&gt;&lt;ul&gt;&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">p</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">locals</span><span class="p">.</span><span class="nx">Products</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Fprint</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&quot;&lt;li&gt;&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Fprint</span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="nx">Name</span><span class="p">)</span>
</span><span class='line'>    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Fprint</span><span class="p">(</span><span class="s">&quot;&lt;/li&gt;&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">fmt</span><span class="p">.</span><span class="nx">Fprint</span><span class="p">(</span><span class="s">&quot;&lt;/ul&gt;&lt;/body&gt;&lt;/html&gt;&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// ... snip ...</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Brute force. Ugly. Fast, very fast.</p>

<p>Each template produces a <code>[]byte</code> which can easily be written to your HTTP response.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='go'><span class='line'><span class="kn">import</span> <span class="s">&quot;templates&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="kd">func</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nx">html</span> <span class="o">:=</span> <span class="nx">templates</span><span class="p">.</span><span class="nx">Products</span><span class="p">(</span><span class="nx">ProductsLocals</span><span class="p">{</span>
</span><span class='line'>    <span class="nx">Title</span><span class="p">:</span> <span class="s">&quot;Products listing&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">Products</span><span class="p">:</span> <span class="nx">products</span><span class="p">,</span>
</span><span class='line'>  <span class="p">})</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">w</span><span class="p">.</span><span class="nx">Write</span><span class="p">(</span><span class="nx">html</span><span class="p">)</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>To learn more about Cote, take a look at the README on Github: <a href="https://github.com/jagregory/cote">https://github.com/jagregory/cote</a>.</p>
</div>
    <div class="meta">
        <div class="date">








  


<time datetime="2013-10-14T16:12:00+11:00" pubdate data-updated="true">Oct 14<span>th</span>, 2013</time></div>
        <div class="tags">

</div>
        
        <span class="comments"><a href="#disqus_thread">Comments</a></span>
        
    </div>
</article>


<section id="comment">
    <h1 class="title">Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</section>
</div>
	<footer class="inner">Copyright &copy; 2013 James Gregory</footer>
	<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script src="/javascripts/slash.js"></script>


<script type="text/javascript">
      var disqus_shortname = 'jagregory';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://www.jagregory.com/writings/compiled-templates-for-go/';
        var disqus_url = 'http://www.jagregory.com/writings/compiled-templates-for-go/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



</body>
</html>