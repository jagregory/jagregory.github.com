<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

    <title>James Gregory</title>
    <meta name="description" content="Jack of all trades, master of none. Principal Consultant at Thoughtworks. Pronouns: he/him
" />

    <meta name="HandheldFriendly" content="True" />
    <meta name="MobileOptimized" content="320" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css" href="/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400" />
    <!-- Customisation  -->
    <link rel="stylesheet" type="text/css" href="/css/main.css" />

</head>
<body class="home-template">

    <header class="main-header post-head no-cover">
    <nav class="main-nav  clearfix">
        <a class="back-button icon-arrow-left" href="/">Home</a>
    </nav>
</header>

<main class="content" role="main">

    <article class="post">

        <header class="post-header">
            <h1 class="post-title">Boo Visual Studio plug-in: 1% complete</h1>
            <section class="post-meta">
                <time class="post-date" datetime="2008-05-18">18 May 2008</time>
                
            </section>
        </header>

        <section class="post-content">
            <p>What do we want? <em>A Boo plug-in for Visual Studio</em>. When do we want it? <em>Sooner, rather than later</em>.</p>

<p>The initial aim of this plug-in is to provide a “good enough” experience when using Boo files within other projects. I’m not currently focussing on doing full-scale development with Boo; so the target is DSLs and Binsor. There won’t be any assemblies created, or anything else that would affect your project. The only difference between how you work now would be that you could write Boo using Visual Studio, with syntax highlighting and intellisense.</p>

<p>That’s for the initial version anyway.</p>

<!-- more -->

<p>I’ve found that creating a plugin for Visual Studio isn’t that difficult, in-fact that’s an understatement, it’s stupidly easy. Most of the plugin architecture is successfully created using the project wizard, so there’s very little I needed to do from that point of view. The tricky part is getting Boo and Visual Studio to communicate.</p>

<p>I started by spending some time looking at the IronPython Studio implementation, the Boo implementation, abstract syntax trees, antlr, and after getting my head around what I needed to do, I set out on my adventure.</p>

<p>So what’s the result? A very basic (and flakey) implementation of both syntax highlighting and intellisense.</p>

<p><img src="/images/booplugin-syntax.jpg" alt="Boo Plugin syntax highlighting" /></p>

<p>The highlighter isn’t perfect yet. It suffers from slowdown when you’re writing an unclosed string, and it can’t handle multi-line statements yet (think comment blocks).</p>

<p><img src="/images/booplugin-codecomplete.jpg" alt="Boo Plugin code completion" /></p>

<p>The intellisense is pretty basic, it allows namespace navigation, and type methods, but there isn’t much in the way of constraints (you can see instance methods against types, for example).</p>

<p>There’s a lot of work to be done, but it’s fun and interesting.</p>

<h2 id="targets">Targets</h2>

<p>In the near future I’d like to get the following done:</p>

<ul>
  <li>Make intellisense work with everything in the local scope</li>
  <li>Make intellisense parse import statements</li>
  <li>Make syntax-highlighting correctly handle multi-line blocks</li>
  <li>Make syntax-highlighting highlight types (like C# does)</li>
</ul>

<p>Then at some point tackle these:</p>

<ul>
  <li>Get Resharper involved</li>
  <li>Refactoring support</li>
</ul>

<p>Hopefully I’ll progress on these and report back in a future post.</p>

<h1 id="code">Code</h1>

<p>The code is poor, it’s a mess and probably all wrong; however, you can get it in the usual place. However, I haven’t provided a direct download because it isn’t really in a state to be distributed yet.</p>

<p>The source is accessible from Subversion at: http://jagregory.googlecode.com/svn/trunk/BooPlugin/ (using user jagregory-read-only)</p>

        </section>

        

        <footer class="post-footer">
            <!-- If we want to display author's name and bio -->
            

            
        </footer>
    </article>
</main>

    <footer class="site-footer clearfix">
      <section class="copyright">
        <a href="mailto:james@jagregory.com">James Gregory</a> &copy;
              2023 &bull; <a rel="me" href="https://aus.social/@jagregory">Mastodon</a> &bull; All content licensed under <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">cc by-nc-sa 4.0</a>.
      </section>
    </footer>

    <script type="text/javascript" src="/js/jquery-1.11.1.min.js"></script>
    <script type="text/javascript" src="/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="/js/index.js"></script>
</body>
</html>
