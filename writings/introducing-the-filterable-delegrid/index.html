
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Introducing the Filterable DeleGrid - James Gregory</title>
  <meta name="author" content="James Gregory">

  
  <meta name="description" content="The DeleGrid is a paged GridView control that handles data-binding through the use of events and delegates rather than with a traditional collection &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.jagregory.com/writings/introducing-the-filterable-delegrid">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="James Gregory" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href='http://fonts.googleapis.com/css?family=Lato' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Cardo:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-3186192-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<logo>

<img src="/logo.png" alt="Website Logo. Upload to /source/logo.png ; disable in /source/_includes/logo.html" height="32px" width="32px">
</logo>



<body >
  <header role="banner"><hgroup>
  <h1><a href="/">James Gregory</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

<br>
  
<!--
<ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
-->

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Introducing the Filterable DeleGrid</h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-03-05T00:00:00+11:00" pubdate data-updated="true">Mar 5<span>th</span>, 2008</time>
        
           | <a href="#disqus_thread"
             data-disqus-identifier="http://www.jagregory.com">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>The DeleGrid is a paged GridView control that handles data-binding through the use of events and delegates rather than with a traditional collection.</p>

<p>What this means is that you have full control over the data that is shown in the currently displayed page. Traditionally you&#8217;d retrieve the whole recordset then page it locally, but with the DeleGrid you can utilise your database/ORMs paging features.</p>

<p>To quote myself from when I first <a href="/writings/delegrid/">introduced the DeleGrid</a>:</p>

<blockquote><p>[The DeleGrid] came about because I wanted a nice way of implementing paging using NHibernate without having the grid know about it. I really didnâ€™t want NHibernate to leave my data layer, so I needed a nice way of the grid calling my DAL with the paging parameters.</p></blockquote>

<h2>What&#8217;s new?</h2>

<p>The biggest change in version 1.1 is the introduction of filtering. The filter isn&#8217;t generated in some black-box fashion, instead it&#8217;s defined by the programmer. It&#8217;s built up from the columns in the grid, which define their own filtering behaviour.</p>

<p>The filter acts upon any columns in the grid that implement the IFilterableField interface. Implementing this interface in your own fields is easy, so you&#8217;re quickly able to create custom filtering behavior for your grid. An example would be a date column, that has a date-picker as a filter control.</p>

<p><img src="/images/fd-1.png" alt="Filter Screenshot" /></p>

<p>I&#8217;ve chosen not to implement the wealth of appearance customisations that are available in the normal templated controls. This is down to two reasons, firstly I don&#8217;t agree with it, appearance should be controlled solely through CSS. Secondly, there are so many, I couldn&#8217;t be bothered. So you&#8217;re only able to attach CSS classes to the buttons and cells, and specify the image urls for the buttons.</p>

<h2>An example implementation</h2>

<p>The grid now has a companion project, it&#8217;s own data library. This separation is to keep you from having to reference System.Web in your data-layer. To use the DeleGrid in your project you&#8217;ll need to reference <code>JAGregory.Controls.DeleGrid.dll</code> and the <code>JAGregory.Controls.Data.dll</code> in your web project, then reference <code>JAGregory.Controls.Data.dll</code> in your data layer, if they&#8217;re separate projects.</p>

<p>So to begin with, add the reference to <code>JAGregory.Controls.DeleGrid.dll</code> and <code>JAGregory.Controls.Data.dll</code> into your web project. This will allow you to use the DeleGrid in your page. Once you&#8217;ve done that, you&#8217;ll need to reference the control in your page, you can either do this using a Register tag in your page, or in the web.config as so:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="nt">&lt;pages&gt;</span>
</span><span class='line'>  <span class="nt">&lt;controls&gt;</span>
</span><span class='line'>    <span class="nt">&lt;add</span> <span class="na">tagPrefix=</span><span class="s">&quot;jag&quot;</span> <span class="na">namespace=</span><span class="s">&quot;JAGregory.Controls&quot;</span>
</span><span class='line'>      <span class="na">assembly=</span><span class="s">&quot;JAGregory.Controls.DeleGrid&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/controls&gt;</span>
</span><span class='line'><span class="nt">&lt;/pages&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>With that in place, you can now put the DeleGrid into your page:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='aspx-cs'><span class='line'><span class="nt">&lt;jag:DeleGrid</span> <span class="na">ID=</span><span class="s">&quot;grid&quot;</span> <span class="na">Runat=</span><span class="s">&quot;server&quot;</span> <span class="na">AllowFiltering=</span><span class="s">&quot;true&quot;</span>
</span><span class='line'>  <span class="na">AutoGenerateColumns=</span><span class="s">&quot;false&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;FilterStyle</span> <span class="na">ToggleOnImageUrl=</span><span class="s">&quot;img/find.png&quot;</span> <span class="na">ToggleOffImageUrl=</span><span class="s">&quot;img/find.png&quot;</span>
</span><span class='line'>      <span class="na">ExecuteImageUrl=</span><span class="s">&quot;img/go.png&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>    <span class="nt">&lt;Columns&gt;</span>
</span><span class='line'>        <span class="nt">&lt;jag:FilterableTextField</span> <span class="na">HeaderText=</span><span class="s">&quot;Name&quot;</span> <span class="na">DataField=</span><span class="s">&quot;Name&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>        <span class="nt">&lt;jag:FilterableBooleanField</span> <span class="na">HeaderText=</span><span class="s">&quot;Active&quot;</span> <span class="na">DataField=</span><span class="s">&quot;Active&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/Columns&gt;</span>
</span><span class='line'><span class="nt">&lt;/jag:DeleGrid&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>In this example I&#8217;m using a Customer object to bind against it, which simply has the Name and Active properties.</p>

<p>For this grid we&#8217;ve set AllowFiltering to true, which enables the filter, then we&#8217;ve set AutoGenerateColumns to false so we can add our own custom columns. The two columns both implement the aforementioned IFilterableField interface, which allows them to define their own filtering behaviour.</p>

<p>I&#8217;ve also set the image urls so the buttons will be visible.</p>

<p>Now that the page is set up, we need to get down to the binding. In your code-behind:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">OnInit</span><span class="p">(</span><span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="k">base</span><span class="p">.</span><span class="n">OnInit</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// attach the events for requesting the data and totals</span>
</span><span class='line'>  <span class="n">grid</span><span class="p">.</span><span class="n">TotalRecordCountRequest</span> <span class="p">+=</span> <span class="n">grid_TotalRecordCountRequest</span><span class="p">;</span>
</span><span class='line'>  <span class="n">grid</span><span class="p">.</span><span class="n">PageDataRequest</span> <span class="p">+=</span> <span class="n">grid_PageDataRequest</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">OnLoad</span><span class="p">(</span><span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="k">base</span><span class="p">.</span><span class="n">OnLoad</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">if</span> <span class="p">(!</span><span class="n">IsPostBack</span><span class="p">)</span>
</span><span class='line'>    <span class="n">grid</span><span class="p">.</span><span class="n">DataBind</span><span class="p">();</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>What&#8217;ve just done is attach the TotalRecordCountRequest and PageDataRequest handlers to the grid, which respectively fetch the total record count for the full grid, and fetch the current page of data from the database; the implementations are below.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">private</span> <span class="n">IEnumerable</span> <span class="nf">grid_PageDataRequest</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">PageDataRequestEventArgs</span> <span class="n">e</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="n">CustomerRepository</span> <span class="n">repos</span> <span class="p">=</span> <span class="k">new</span> <span class="n">CustomerRepository</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// get the requested page of data from the database</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">repos</span><span class="p">.</span><span class="n">FindAllPaged</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">Range</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">Sort</span><span class="p">,</span> <span class="n">e</span><span class="p">.</span><span class="n">Filters</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">private</span> <span class="kt">int</span> <span class="nf">grid_TotalRecordCountRequest</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">DataRequestEventArgs</span> <span class="n">e</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="n">CustomerRepository</span> <span class="n">repos</span> <span class="p">=</span> <span class="k">new</span> <span class="n">CustomerRepository</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// get the total records</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">repos</span><span class="p">.</span><span class="n">GetAllCount</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">Filters</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>I&#8217;m using a <a href="http://www.martinfowler.com/eaaCatalog/repository.html">repository pattern</a> to handle data-access. In the PageDataRequest handler we&#8217;re taking the range, sort, and filter info that the grid passed us and sending it off to the repository to get the data. Similarity the TotalRecordCountRequest handler does a similar thing but without the range or sort info.</p>

<p>That&#8217;s it really for using the DeleGrid, you just need to take the filter info and handle it using your specific ORM.</p>

<h2>Repository implementation</h2>

<p>Ok I&#8217;ll throw you a bone, here&#8217;s the repository implementation to show how easy it is using NHibernate:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
</pre></td><td class='code'><pre><code class='csharp'><span class='line'><span class="k">public</span> <span class="k">class</span> <span class="nc">CustomerRepository</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="c1">/// &lt;summary&gt;</span>
</span><span class='line'>  <span class="c1">/// Creates a NHibernate ICriteria based on the filters.</span>
</span><span class='line'>  <span class="c1">/// &lt;/summary&gt;</span>
</span><span class='line'>  <span class="c1">/// &lt;param name=&quot;filters&quot;&gt;Filters to apply.&lt;/param&gt;</span>
</span><span class='line'>  <span class="c1">/// &lt;returns&gt;ICriteria&lt;/returns&gt;</span>
</span><span class='line'>  <span class="k">private</span> <span class="n">ICriteria</span> <span class="nf">CreateFilteredCriteria</span><span class="p">(</span><span class="n">FilterCriterionCollection</span> <span class="n">filters</span><span class="p">)</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>    <span class="n">ICriteria</span> <span class="n">criteria</span> <span class="p">=</span> <span class="n">SessionManager</span><span class="p">.</span><span class="n">CurrentSession</span>
</span><span class='line'>      <span class="p">.</span><span class="n">CreateCriteria</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">Customer</span><span class="p">));</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// criterion handling - write this yourself depending on how your</span>
</span><span class='line'>    <span class="c1">// db filters (and what filter types you&#39;re supporting)</span>
</span><span class='line'>    <span class="k">foreach</span> <span class="p">(</span><span class="n">FilterCriterion</span> <span class="n">filter</span> <span class="k">in</span> <span class="n">filters</span><span class="p">)</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="n">filter</span><span class="p">.</span><span class="n">Type</span> <span class="p">==</span> <span class="k">typeof</span><span class="p">(</span><span class="kt">string</span><span class="p">))</span>
</span><span class='line'>        <span class="n">criteria</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="n">Like</span><span class="p">(</span><span class="n">filter</span><span class="p">.</span><span class="n">FieldName</span><span class="p">,</span> <span class="s">&quot;%&quot;</span> <span class="p">+</span> <span class="n">filter</span><span class="p">.</span><span class="n">Value</span> <span class="p">+</span> <span class="s">&quot;%&quot;</span><span class="p">));</span>
</span><span class='line'>      <span class="k">else</span> <span class="nf">if</span> <span class="p">(</span><span class="n">filter</span><span class="p">.</span><span class="n">Type</span> <span class="p">==</span> <span class="k">typeof</span><span class="p">(</span><span class="kt">bool</span><span class="p">))</span>
</span><span class='line'>        <span class="n">criteria</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">Expression</span><span class="p">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">filter</span><span class="p">.</span><span class="n">FieldName</span><span class="p">,</span> <span class="n">filter</span><span class="p">.</span><span class="n">Value</span><span class="p">));</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="n">criteria</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">/// &lt;summary&gt;</span>
</span><span class='line'>  <span class="c1">/// Gets the total record count from the database using the filters.</span>
</span><span class='line'>  <span class="c1">/// &lt;/summary&gt;</span>
</span><span class='line'>  <span class="c1">/// &lt;param name=&quot;filters&quot;&gt;Filters to apply before getting the count.&lt;/param&gt;</span>
</span><span class='line'>  <span class="c1">/// &lt;returns&gt;Total number of records in the filtered list&lt;/returns&gt;</span>
</span><span class='line'>  <span class="k">public</span> <span class="kt">int</span> <span class="nf">GetAllCount</span><span class="p">(</span><span class="n">FilterCriterionCollection</span> <span class="n">filters</span><span class="p">)</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nf">CreateFilteredCriteria</span><span class="p">(</span><span class="n">filters</span><span class="p">)</span>
</span><span class='line'>      <span class="p">.</span><span class="n">SetProjection</span><span class="p">(</span><span class="n">Projections</span><span class="p">.</span><span class="n">Count</span><span class="p">(</span><span class="s">&quot;ID&quot;</span><span class="p">))</span>
</span><span class='line'>      <span class="p">.</span><span class="n">UniqueResult</span><span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;();</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">/// &lt;summary&gt;</span>
</span><span class='line'>  <span class="c1">/// Gets one page of data from the database.</span>
</span><span class='line'>  <span class="c1">/// &lt;/summary&gt;</span>
</span><span class='line'>  <span class="c1">/// &lt;param name=&quot;range&quot;&gt;Select range (start ID and number of records).&lt;/param&gt;</span>
</span><span class='line'>  <span class="c1">/// &lt;param name=&quot;sort&quot;&gt;Sorting to apply.&lt;/param&gt;</span>
</span><span class='line'>  <span class="c1">/// &lt;param name=&quot;filters&quot;&gt;Filters to apply.&lt;/param&gt;</span>
</span><span class='line'>  <span class="c1">/// &lt;returns&gt;List for one page of data.&lt;/returns&gt;</span>
</span><span class='line'>  <span class="k">public</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;</span> <span class="n">FindAllPaged</span><span class="p">(</span><span class="n">SelectRange</span> <span class="n">range</span><span class="p">,</span> <span class="n">SortInfo</span> <span class="n">sort</span><span class="p">,</span> <span class="n">FilterCriterionCollection</span> <span class="n">filters</span><span class="p">)</span>
</span><span class='line'>  <span class="p">{</span>
</span><span class='line'>    <span class="c1">// create the criteria using the filters, then set the range</span>
</span><span class='line'>    <span class="n">ICriteria</span> <span class="n">criteria</span> <span class="p">=</span> <span class="n">CreateFilteredCriteria</span><span class="p">(</span><span class="n">filters</span><span class="p">)</span>
</span><span class='line'>      <span class="p">.</span><span class="n">SetFirstResult</span><span class="p">(</span><span class="n">range</span><span class="p">.</span><span class="n">Start</span><span class="p">)</span>
</span><span class='line'>      <span class="p">.</span><span class="n">SetMaxResults</span><span class="p">(</span><span class="n">range</span><span class="p">.</span><span class="n">Size</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// only add the sort if one is specified</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(!</span><span class="kt">string</span><span class="p">.</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="n">sort</span><span class="p">.</span><span class="n">Field</span><span class="p">))</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="n">sort</span><span class="p">.</span><span class="n">Direction</span> <span class="p">==</span> <span class="n">Direction</span><span class="p">.</span><span class="n">Asc</span><span class="p">)</span>
</span><span class='line'>        <span class="n">criteria</span><span class="p">.</span><span class="n">AddOrder</span><span class="p">(</span><span class="n">Order</span><span class="p">.</span><span class="n">Asc</span><span class="p">(</span><span class="n">sort</span><span class="p">.</span><span class="n">Field</span><span class="p">));</span>
</span><span class='line'>      <span class="k">else</span>
</span><span class='line'>        <span class="n">criteria</span><span class="p">.</span><span class="n">AddOrder</span><span class="p">(</span><span class="n">Order</span><span class="p">.</span><span class="n">Desc</span><span class="p">(</span><span class="n">sort</span><span class="p">.</span><span class="n">Field</span><span class="p">));</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="n">criteria</span><span class="p">.</span><span class="n">List</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;();</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The <code>CreateFilteredCriteria</code> method is doing most of the leg work. It takes creates an NHibernate criteria, then adds any filter criterions to it. It iterates the filters collection, checking their type and adding the appropriate NHibernate criterion. Simple!</p>

<h2>The example project</h2>

<p>I&#8217;ve attached a sample project that uses the grid to display a collection of customers that are paged and filtered. The example uses a SQLite database with NHibernate for data-access, I&#8217;ve done this to keep the extraneous code to a minimum.</p>

<h2>Downloads</h2>

<p>The DeleGrid is open-source under the <a href="http://en.wikipedia.org/wiki/BSD_license">new BSD License</a>; read the license for what youâ€™re allowed to do.</p>

<p>You can download the source here: <a href="http://jagregory.googlecode.com/files/DeleGrid-1.1-source.zip">Download Source</a>.
You can download the latest binary here: <a href="http://jagregory.googlecode.com/files/DeleGrid-1.1.zip">Download Binary</a>.
You can download the example project here: <a href="http://jagregory.googlecode.com/files/DeleGridExample.zip">Download Example</a>.</p>

<p>The source is also accessible from Subversion at: <a href="http://jagregory.googlecode.com/svn/trunk/DeleGrid/">http://jagregory.googlecode.com/svn/trunk/DeleGrid/</a> (using user jagregory-read-only)</p>
</div>


  <footer>
    
      <div class="sharing">
  
  
  
</div>

    
    <p class="meta">
      
  

<span class="byline author vcard">Text authored by <span class="fn">James Gregory</span></span>


      


    </p>
    <p class="meta">
      
        <a class="basic-alignment left" href="/writings/objectfield-11/" title="Previous Post: ObjectField 1.1">&laquo; ObjectField 1.1</a>
      
      
        <a class="basic-alignment right" href="/writings/getfilename-nant-task/" title="Next Post: getfilename NAnt task">getfilename NAnt task &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Website copyright &copy; 2014 - James Gregory |
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a> | Themed with <a href="https://github.com/TheChymera/Koenigspress">KÃ¶nigspress</a></span>.
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'jagregory';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>











</body>
</html>
