
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Boo Visual Studio Plug-in: 1% Complete - James Gregory</title>
  <meta name="author" content="James Gregory">

  
  <meta name="description" content="What do we want? A Boo plug-in for Visual Studio. When do we want it? Sooner, rather than later. The initial aim of this plug-in is to provide a &# &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.jagregory.com/writings/boo-visual-studio-plug-in-1-complete">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  
  <link href="/atom.xml" rel="alternate" title="James Gregory" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href='http://fonts.googleapis.com/css?family=Lato' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Cardo:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-3186192-13']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<logo>

<img src="/logo.png" alt="Website Logo. Upload to /source/logo.png ; disable in /source/_includes/logo.html" height="32px" width="32px">
</logo>



<body >
  <header role="banner"><hgroup>
  <h1><a href="/">James Gregory</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

<br>
  
<!--
<ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
-->

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Boo Visual Studio Plug-in: 1% Complete</h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-05-18T00:00:00+10:00" pubdate data-updated="true">May 18<span>th</span>, 2008</time>
        
           | <a href="#disqus_thread"
             data-disqus-identifier="http://www.jagregory.com">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>What do we want? <em>A Boo plug-in for Visual Studio</em>. When do we want it? <em>Sooner, rather than later</em>.</p>

<p>The initial aim of this plug-in is to provide a &#8220;good enough&#8221; experience when using Boo files within other projects. I&#8217;m not currently focussing on doing full-scale development with Boo; so the target is DSLs and Binsor. There won&#8217;t be any assemblies created, or anything else that would affect your project. The only difference between how you work now would be that you could write Boo using Visual Studio, with syntax highlighting and intellisense.</p>

<p>That&#8217;s for the initial version anyway.</p>

<p>I&#8217;ve found that creating a plugin for Visual Studio isn&#8217;t that difficult, in-fact that&#8217;s an understatement, it&#8217;s stupidly easy. Most of the plugin architecture is successfully created using the project wizard, so there&#8217;s very little I needed to do from that point of view. The tricky part is getting Boo and Visual Studio to communicate.</p>

<p>I started by spending some time looking at the IronPython Studio implementation, the Boo implementation, abstract syntax trees, antlr, and after getting my head around what I needed to do, I set out on my adventure.</p>

<p>So what&#8217;s the result? A very basic (and flakey) implementation of both syntax highlighting and intellisense.</p>

<p><img src="/images/booplugin-syntax.jpg" alt="Boo Plugin syntax highlighting" /></p>

<p>The highlighter isn&#8217;t perfect yet. It suffers from slowdown when you&#8217;re writing an unclosed string, and it can&#8217;t handle multi-line statements yet (think comment blocks).</p>

<p><img src="/images/booplugin-codecomplete.jpg" alt="Boo Plugin code completion" /></p>

<p>The intellisense is pretty basic, it allows namespace navigation, and type methods, but there isn&#8217;t much in the way of constraints (you can see instance methods against types, for example).</p>

<p>There&#8217;s a lot of work to be done, but it&#8217;s fun and interesting.</p>

<h2>Targets</h2>

<p>In the near future I&#8217;d like to get the following done:</p>

<ul>
  <li>Make intellisense work with everything in the local scope</li>
  <li>Make intellisense parse import statements</li>
  <li>Make syntax-highlighting correctly handle multi-line blocks</li>
  <li>Make syntax-highlighting highlight types (like C# does)</li>
</ul>


<p>Then at some point tackle these:</p>

<ul>
  <li>Get Resharper involved</li>
  <li>Refactoring support</li>
</ul>


<p>Hopefully I&#8217;ll progress on these and report back in a future post.</p>

<h1>Code</h1>

<p>The code is poor, it&#8217;s a mess and probably all wrong; however, you can get it in the usual place. However, I haven&#8217;t provided a direct download because it isn&#8217;t really in a state to be distributed yet.</p>

<p>The source is accessible from Subversion at: http://jagregory.googlecode.com/svn/trunk/BooPlugin/ (using user jagregory-read-only)</p>
</div>


  <footer>
    
      <div class="sharing">
  
  
  
</div>

    
    <p class="meta">
      
  

<span class="byline author vcard">Text authored by <span class="fn">James Gregory</span></span>


      


    </p>
    <p class="meta">
      
        <a class="basic-alignment left" href="/writings/plugin-baby-steps/" title="Previous Post: Plugin baby steps">&laquo; Plugin baby steps</a>
      
      
        <a class="basic-alignment right" href="/writings/freeing-the-model-from-its-evil-web-service-oppressors/" title="Next Post: Freeing the model from its evil web-service oppressors">Freeing the model from its evil web-service oppressors &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Website copyright &copy; 2014 - James Gregory |
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a> | Themed with <a href="https://github.com/TheChymera/Koenigspress">KÃ¶nigspress</a></span>.
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'jagregory';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>











</body>
</html>
